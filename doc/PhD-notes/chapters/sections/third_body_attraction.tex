\subsubsection{Third Body Attraction}\label{sssec:third-body-attraction}

The presence of other bodies in the gravitational ﬁeld exerted by a main central
body makes the problem of orbit determination a $N$-body problem, which however, as known, 
cannot be solved analytically. In case of artiﬁcial satellites orbiting the Earth 
at low altitudes, the gravitational force due to the Earth is by far stronger than 
those exerted by the Moon, Sun and/or planets. Therefore, the problem can be solved 
by using the methods of the perturbation theory.

If we introduce the vectors $\bm{r}$ and $\bm{s}$, to describe the geocentric 
coordinates of the satellite and the third-body respectively, then according to 
Newton's law, the acceleration of the satellite by the third-body, considered as 
a point mass, is (the subscript $pb$ denotes the \emph{perturbing body})
\begin{equation}
    \bm{\ddot{r}} = GM_{pb} \frac{\bm{s}-\bm{r}}
        {\norm{\bm{s}-\bm{r}}^3}
\end{equation}
where we have to also account for Earth's acceleration due to the perturbing body, 
hence
\begin{equation}\label{eq:mont337}
    \bm{\ddot{r}} = GM_{pb} \left( 
        \frac{\bm{s}-\bm{r}}{\norm{\bm{s}-\bm{r}}^3} 
        - \frac{s}{\norm{s}^3} \right)
\end{equation}

\paragraph{\gls{jpl} Ephemerides}\label{par:jpl-ephemerides}

To compute third body perturbation, as evident from \ref{eq:mont337}, we need to 
know the coordinates of the perturbing body at a given instant $t$. For high 
precision applications, Sun, Moon and planetary ephemerides are used and interpolated 
for the requested epoch.

\gls{jpl} Development Ephemeris (abbreved \texttt{JPL DE(number)}, or simply DE(number)) 
designates one of a series of mathematical models of the Solar System produced at the 
\href{https://www.jpl.nasa.gov/}{\gls{jpl}} for use in spacecraft navigation and astronomy. 
The models consist of numeric representations of positions, velocities and accelerations 
of major Solar System bodies, tabulated at equally spaced intervals of time, covering 
a specified span of years (\cite{wiki-jplde}). Further information and a description of 
vailable ephemerides, can be found at the 
\href{https://ssd.jpl.nasa.gov/planets/eph_export.html}{\gls{jpl} Planetary and Lunar Ephemerides} 
website.

For the purposes of this Thesis, we have developed software to interact with the 
\gls{jpl} DE files, generic enough to handle all versions of the ephemerides. 
We use an interface to the \gls{jpl}-provided Observation Geometry System
for Space Science Missions (\href{https://naif.jpl.nasa.gov/naif/}{SPICE}) 
software library \footnote{based on the C version of the the 
\href{https://naif.jpl.nasa.gov/naif/toolkit_C.html}{Navigation and Ancillary Information Facilty (NAIF)}} 
to extract Sun, Moon and planet coordinates, and respective constants. Tests and 
validation are performed using the \texttt{DE421} ephemerides (\cite{Folkner2009}).
