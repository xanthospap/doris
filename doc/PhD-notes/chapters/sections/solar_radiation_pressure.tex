\subsubsection{Solar Radiation Pressure}\label{sssec:solar-radiation-pressure}

\info{New section}An Earth orbiting satellite exposed to solar radiation, experiences a small force 
arising from the absorption or reflection of photons. The effect depends on the
satellite's mass and surface area. The primary radiation source to be considered 
in satellite geodesy is the Sun. The radiation pressure due to the direct solar 
radiation is also referred to as \emph{direct radiation pressure}. Other sources 
of radiation are the Earth, which reﬂects and/or re-emits the radiation received 
by the Sun, or to a much lesser extent, the Moon, reﬂecting the solar radiation. 
Radiation pressure is the dominating non-gravitational perturbation above heights 
of about \SI{600}{\km} (\cite{BeutlerVII}).

The radiation ﬁeld due to the direct solar radiation may be considered as
parallel to the direction \(Sun \to Satellite\). This implies that for the computation 
of solar radiation pressure, the surface of the cross section of the satellite 
normal to the direction \(Sun \to Satellite\) needs to be known.

Assuming rotational symmetry of the satellite w.r.t. the axis \(Sun \to Satellite\), 
the acceleration due to the direct solar radiation may be written as (\cite{BeutlerVII})
\begin{equation}
    \label{eq:mont375}
    \bm{\ddot{r}} = -P_{\Sun} C_R \frac{A}{m} 
    \frac{\bm{r} - \bm{r}_{\Sun}}{\norm{\bm{r} - \bm{r}_{\Sun}}^3}
    \SI{1}{\astronomicalunit}^2
\end{equation}
where:
\begin{itemize}
\item[$P_{\Sun}$] is the Sun's solar flux at a distance of \SI{1}{\astronomicalunit}, 
  $P_{\Sun} \approx \SI{4.56e-6}{\newton\per\meter\tothe{2}}$
\item[\({C_R}\)] is the \emph{radiation pressure coefficient} depending on the 
  \emph{refractivity} $\varepsilon$ of the satellite, 
\item[\(\bm{r}\)] is the geocentric position vector of the satellite,
\item[\(\bm{r_{\Sun}}\)] is the geocentric position vector of the Sun,
\item[\si{\astronomicalunit}] is the Astronomical Unit,
\item[\(m\)] is the mass of the satellite, and
\item[\(A\)] is the cross section of the satellite normal to the direction 
  \(Sun \to Satellite\)
\end{itemize}
$C_R$ is usually estimated during a \gls{pod} process. For high-precision applications, 
a complex micro model may be established prior to the mission, which is used to
adjust parameters of a simplified macro model, applied during routine spacecraft
operations. To this end, a finite element method is applied to
model the complex spacecraft shape and orientation, the optical and thermal prop-
erties of the surfaces, and the impinging radiation (\cite{Montenbruck2000}).

\paragraph{Partial Derivatives}\label{par:solar-radiation-pressure-partials}
Starting from \ref{eq:mont375}, the acceleration due to solar radiation pressure 
aries with the satellite position in the same way as the gravitational attraction
of the Sun, with derivatives given by:
\begin{equation}
  \label{eq:mont777}
  \frac{\partial \ddot{\bm{r}}}{\partial \bm{r}} = 
  P_{\Sun} C \frac{A}{m} {AU}^2 \left( 
    \frac{1}{\norm{\bm{r} - \bm{r}_{\Sun}}^3} \bm{I}_{3\times 3}
    -3 \left( \bm{r} - \bm{r}_{\Sun} \right) 
      \frac{\left( \bm{r} - \bm{r}_{\Sun} \right) ^T}{\norm{\bm{r} - \bm{r}_{\Sun}}^5}
      \right)
\end{equation}

Due to the fact that the radiation pressure coefficient $C$ is usually estimated 
during orbit determination, the derivative of the acceleration w.r.t $C$ must 
be calculated. The respective partials are:
\begin{equation}
  \label{eq:mont778}
  \frac{\partial \ddot{\bm{r}}}{\partial C} = \frac{1}{C} \ddot{\bm{r}} = 
  -P_{\Sun} \frac{A}{m} 
  \frac{\bm{r} - \bm{r}_{\Sun}}{\norm{\bm{r} - \bm{r}_{\Sun}}^3} {AU}^2
\end{equation}
required to compute the influence of variations in the radiation pressure
coefficient on the satellite trajectory.

Radiation pressure obviously is ``turned oﬀ'' if the radiation is blocked by an 
``obstacle'', i.e the Moon or Earth, between the Sun and the satellite. 

\paragraph{Satellite Eclispes and Earth Shadow}\label{par:occultation}
Satellites routinely enter eclipse periods during their orbits, resulting in 
fluctuations in the experienced solar radiation pressure. When a satellite enters 
the \emph{umbra} or the \emph{penumbra} area of an occulting body (e.g., the 
Earth or the Moon), a satellite shadow function model is used to estimate the 
occultation degree. For the purposes of this Thesis, the so called \emph{conical model} 
is used (\cite{Zhang2019}) to compute occulatation factor.

For the conical model and using the Earth as an occulting body, the following 
angles are defined:
\begin{gather}
  \theta _{\Earth} = \arcsin \left( \frac{R_{\Earth}}{\norm{\bm{r}}} \right) \\
  \theta _{\Sun}   = \arcsin \left( \frac{R_{\Sun}}{\norm{\bm{r}_{\Sun} - \bm{r}}} \right) \\
  \theta           = \arccos \left( \frac{-\bm{r}^{T} \left( \bm{r}_{\Sun} - \bm{r}\right)}{\norm{\bm{r}}\norm{\bm{r}_{\Sun} - \bm{r}}} \right)
\end{gather}
When $\theta \ge \theta _{\Earth} + \theta _{\Sun}$ occultation does not take place. 
If $\theta \le \theta _{\Earth} - \theta _{\Sun}$ occultation is total. Partial 
occultation takes place if 
$\norm{\theta _{\Earth} - \theta _{\Sun}} < \theta < \theta _{\Earth} + \theta _{\Sun}$. 
In this latter case, an occultation factor is computed, as
\begin{equation}
  F = 1 - \frac{S}{\pi \theta _{\Sun} ^2}
\end{equation}
where $S$ is the occulted area. Shadow models considering the Earth's oblateness 
and the atmospheric effec can be found in e.g. \cite{Zhang2022}.



\iffalse
Examining \ref{fig:eclipse-geometry}, we are interested in two main regions: the 
\emph{umbra} is totally eclipsed by the primary body (Earth); the \emph{penumbra} 
is only partially obscured by the primary.
\begin{equation}
    \sin({\alpha}_{umb}) = \frac{r_S - r_E}{R} \text{ and }
    \sin({\alpha}_{pen}) = \frac{r_S + r_E}{R}
\end{equation}

If we consider the the primary (or occulting) body to be the Earth and the 
secondary body to be the Sun, then:
\begin{equation}
    \sin({\alpha}_{umb}) = \frac{r_{\Sun} - r_{\Earth}}{R_{\Earth\Sun}} 
    \Rightarrow {\alpha}_{umb} \approx \SI{0.264}{\degree}
    \text{ and }
    \sin({\alpha}_{pen}) = \frac{r_{\Sun} + r_{\Earth}}{R_{\Earth\Sun}}
    \Rightarrow {\alpha}_{pen} \approx \SI{0.269}{\degree}
\end{equation}

\begin{figure}
\centering
\input{tikz/eclipse-geometry.tikz}
\caption{Eclipse Geometry; \emph{scales are greatly exaggerated}}
\label{fig:eclipse-geometry}
\end{figure}

The distance from the occulting planet to the vertex (\(V\)) can be found via 
using the similar triangles (see \ref{fig:eclipse-geometry}):
\begin{equation}
    \label{eq:val501}
    \frac{\overline{EV}}{r_{E}} = \frac{\overline{SV}}{r_S} \Rightarrow \overline{EV} = \overline{SV} \frac{r_E}{r_S}
\end{equation}
We know the (ralative) position of the two (primary and secondary) planets, hence:
\(\overline{SV} = R + \overline{EV}\); substituting into \ref{eq:val501} yields:
\begin{align*}
    \label{eq:val51}
    \overline{EV} &= R \frac{r_E}{r_S} + \overline{EV} \frac{r_E}{r_S} \\
    \overline{EV} (1-\frac{r_E}{r_S}) &= R \frac{r_E}{r_S} \\
    \overline{EV} &= R \frac{r_E}{r_S - r_E}
\end{align*}

Using values for the Earth and the Sun, we find \(\overline{PV}\) to 
be \SI{1.384e6}{\km}. This is almost four times the distance from the 
Earth to the Moon (\SI{3.8268e5}{\km}) (\cite{Vallado}). Hence, it comes as little surprise 
that the Earth's shadow sometimes completely obscures the Moon, causing a 
lunar eclipse. Using values for the Moon and the Sun, 
\ref{eq:val51} yields a value of about \SI{3.735e5}{\km} (\cite{Vallado}) 
which is not too far from the Earth-Moon distance (approximately 
\SI{3.844e5}{\km}). When the Moon obscures part of the Earth's surface with its 
shadow, it causes a \emph{solar eclipse}.
\fi