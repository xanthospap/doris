\subsubsection{Solid Earth Tide}\label{sssec:earth-tide-perturbations}

Apart from the direct force third bodies (Moon and Sun) induce on earth orbiting 
satellites (see \autoref{sssec:third-body-perturbations}), they also have an effect on 
the body of the Earth, resulting in \emph{tidal} phenomena. The latter produce 
small periodic deformations of the solid body of the Earth called \emph{earth tides} 
or \emph{solid earth tides}, which lead to periodic variations in the Earth's gravity 
field. These tidal perturbations have to be addressed in the case of \gls{pod}. 
Note that his section is centered on the effect of solid Earth tides on the geopotential; 
tidal forces though, via the deformation they cause on the Earth's crust, result in 
site displacements (e.g. on instrumentation sites) that have to be addressed when 
processing observations from Earth to satellites (see ??).

Solid earth tide effects, include the direct attraction of the tide generating 
potential, as well as deformations and associated geopotential changes arising 
from oceanic loading (which cause a loading of the crust) and wobbles of the 
mantle and the core regions (causing incremental centrifugal potentials). More 
information on tidal theory can be found in \cite{Wilhelm1997}, \cite{iers2010} 
and references therein. 

The perturbations of satellite orbits from the lunisolar solid Earth tides are
derived by an expansion of the tidal-induced gravity potential using spherical 
harmonics in a similar way as for the ``static'' gravity field of the Earth 
(\cite{Montenbruck2000}). The contributions $\Delta C_{nm}$ and $\Delta S_{nm}$ 
from the tides are expressible in terms of the \emph{Love} number $\lovek$ (two 
$k$ parameters are needed for $n=2$ namely $\lovek ^{(0)}_{nm}$ and $\lovek ^{(+)}_{nm}$, 
while three such parameters are needed for $n \ne 2$, namely $\lovek ^{(0)}_{nm}$, 
$\lovek ^{(+)}_{nm}$ and $\lovek ^{(-)}_{nm}$, the latter being $0$ in the case 
of $n=2$). These parameters include a small imaginary part, due to the mantle's 
anelasticity (reflecting a phase lag in the deformational response of the Earth 
to tidal forces) \cite{iers2010}.

Hereafter, the treatment of earth tides as described in \cite{iers2010} is
adopted. Practically, the computation of the tidal contributions to the 
geopotential coefficients is most efficiently done by a three-step procedure. 
In the following, a summary of the process for computing the contributions 
$\Delta C_{nm}$ and $\Delta S_{nm}$, as performed in the software developed for 
this Thesis is presented; further information can be found in \cite{iers2010}. 
Results for a one-day arc of \gls{grace} are given in \autoref{fig:04solidEarthTide-icrf}; 
dataset was chosen to match the \texttt{COST-G} benchmark test.
 
\paragraph{Step 1 Corrections}\label{par:step1-corr-earth-tides}
In Step 1, the $(2m)$ part of the tidal potential is evaluated in the 
time domain for each $m$ using lunar and solar ephemerides, and the 
corresponding changes $\Delta \bar{C}_{2m}$ and $\Delta \bar{S}_{2m}$ are 
computed using frequency independent nominal values $\lovek _{2m}$ for the 
respective $\lovek ^{(0)}_{2m}$. The contributions of the degree 3 tides to
$\bar{C}_{3m}$ and $\bar{S}_{3m}$ through $\lovek ^{(0)}_{3m}$ and also of 
those of the degree 2 tides to $\bar{C}_{4m}$ and $\bar{S}_{4m}$ through 
$\lovek ^{(+)}_{2m}$ may be computed by a similar procedure.

With frequency-independent values $\lovek _{nm}$, changes induced by the 
$(nm)$ part of the \gls{tgp} in the \emph{normalized} geopotentials 
coefficients of the same degree and order $(nm)$, are given in the time 
domain by (\cite{iers2010}):
\begin{equation}
\Delta \bar{C}_{nm} - \iim \Delta \bar{S}_{nm} = \frac{\lovek _{nm}}{2n+1}
  \sum^{3}_{j=2} \frac{GM_j}{GM_\Earth} \left( \frac{R_e}{r_j} \right) ^{n+1} 
  \bar{P}_{nm} \left( \sin \Phi _j \right) e^{-\iim m \lambda _j}
  \label{eq:iers1066}
\end{equation}
where:
\begin{description}
  \item $\lovek _{nm}$\footnote{Tables of relevant Love numbers are listed 
    in \cite{iers2010}, Table 6.3. Note that in the $n=2$ case, $k_{2m}$ have a 
    non-zero imaginary part $k_{2m} = \Re(k_{2m}) + i\Im(k_{2m})$, hence 
    \autoref{eq:iers1066} expands to
    \begin{equation}
      \begin{Bmatrix} \Delta \bar{C}_{nm} \\ \Delta \bar{S}_{nm} \end{Bmatrix}
      = \frac{1}{5} \frac{GM_j}{GM_\Earth} \left( \frac{R_e}{r_j} \right) ^{3} \bar{P}_{2m} 
      \begin{Bmatrix}
        \Re(k_{2m}) \cos{m\lambda _j} + \Im(k_{2m}) \sin{m\lambda _j} \\
        \Re(k_{2m}) \sin{m\lambda _j} - \Im(k_{2m}) \cos{m\lambda _j}
      \end{Bmatrix}
    \end{equation}
    } is the nominal Love number for degree 
    $n$ and order $m$, 
  \item $R_e$ and $GM_{\Earth}$ are the equatorial radius and the 
    gravitational parameter of the Earth,
  \item $GM_j$ is the gravitational parameter of the Moon and Sun, for 
    $j=2$ and $j=3$ respectively,
  \item $\Phi _j$ is the body-fixed geocentric latitude of the Moon and 
    Sun ($j$ indexes as above), and
  \item $\lambda _j$ is the body-fixed (east) longitude of the Moon and 
    Sun ($j$ indexes as above)
\end{description}

For $n=4$, formula \autoref{eq:iers1066} becomes (\cite{iers2010}):
\begin{equation}
\Delta \bar{C}_{4m} - \iim \Delta \bar{S}_{4m} = \frac{\lovek _{nm}}{5}
  \sum^{3}_{j=2} \frac{GM_j}{GM_\Earth} \left( \frac{R_e}{r_j} \right) ^{3} 
  \bar{P}_{2m} \left( \sin \Phi _j \right) e^{-\iim m \lambda _j} \text{ for } m=0,1,2
  \label{eq:iers1067}
\end{equation}
to account for the changes in the degree 4 coefficients produced by the 
degree 2 tides.

In summary, via Step 1, corrections for 
\begin{equation}
  \Delta \bar{C}_{nm}, \Delta \bar{S}_{nm} \text{ for }
    \begin{cases}
      n=2 & m=0,1,2 \\
      n=3 & m=0,1,2,3 \\
      n=4 & m=0,1,2\\
    \end{cases}
\end{equation} 
are computed.

\paragraph{Step 2 Corrections}\label{par:step2-corr-earth-tides}
In Step 2, corrections for the deviations of the $\lovek ^{(0)}_{21}$ from the 
constant nominal value $\lovek _{21}$ assumed (for this band) in the first step 
are computed. Similar corrections need to be applied to a few of the constituents 
of the other two bands also.

The contribution to $\Delta \bar{C}_{20}$ from the long period tidal 
constituents, each with a frequency $f$, can be computed by (\cite{iers2010}):
\begin{equation}
  \Re \Bigl\{ \sum _{f(2,0)}(A_0 \delta k_f H_f) e^{\iim \theta _f} \Bigr\} = 
    \sum_{f(2,0)} \left[ \left(A_0 H_h \delta k^\Re _f \right) \cos \theta _f 
      - \left(A_0 H_h \delta k^\Im _f \right) \sin \theta _f 
    \right]
  \label{eq:iers1068a}
\end{equation}

Furthermore, computation of the contribution for $(nm)=(21)$ from the 
diurnal tidal constituents and to $(22)$ from the semidiurnal can be computed using 
(\cite{iers2010}):
\begin{equation}
  \Delta \bar{C}_{2m} - \iim \Delta \bar{C}_{2m} = 
    \eta _m \cdot \sum _{f(2,m)} \left( A_m \delta k_f H_f\right) e^{\iim \theta _f} 
    \text{ for } m=1,2
  \label{eq:iers1068b}
\end{equation}
where 
\begin{description}
  \item $\delta k_f = \delta k^\Re _f + \iim \delta k^\Im _f$ is the difference 
    between $k_f$ defined as $k^{(0)}_{2m}$ at frequency $f$ and the 
    nominal value ($k_f - k_{2m}$), plus a contribution from ocean 
    loading. Values of the imaginary and real part, $\delta k^\Re _f$ and 
    $\delta k^\Im _f$ respectively, can be found in \cite{iers2010}, Tables 6.5a 
    through 6.5c. Note however, that in the computation we use the amplitude values 
    for the in-phase and out-of-phase components ($A_{in-phase} = \left(A_m H_f \delta k^\Re _f \right)$ 
    and $A_{out-of-phase} = \left( A_m H_f \delta k^\Im _f \right)$) directly, recorded 
    in the same tables.
  \item $H_f$ is the amplitude (in meters) of the term at frequency $f$
  \item $\theta _f$ is given by 
    \begin{equation} \theta _f = m \cdot ( \theta _g + \pi ) - \sum ^5_{j=1} N_j F_j \end{equation}
    where $\theta _g$ is the \gls{gmst} expressed in angle units.
    Here we use the expression based on the expansion using the \emph{Fundamental Arguments}. 
    For alternate formulations, e.g. using the \emph{Doodson} arguments, see 
    \cite{iers2010}, Sec. 6.2.1.
  \item The terms $\eta _m$ and $A_m$, are given by: 
    \begin{equation}
    \eta _m = 
      \begin{cases} -\iim , m=1 \\ 1 , m=2\end{cases}
    \end{equation} and\footnote{As with the $\delta k^\Re _f$ and $\delta k^\Im _f$ terms 
    explicit computation of $A_m$ is not needed if the 
    amplitude terms $A_{in-phase}$ and $A_{out-of-phase}$ are used from 
    \cite{iers2010} Tables 6.5a through 6.5c.}
    \begin{equation} 
      A_m = \begin{cases} 
          \frac{1}{R_{\Earth}\sqrt{4 \pi}}, m=0\\
          \frac{(-1)^m}{R_{\Earth}\sqrt{8 \pi}}, m \ne 0
      \end{cases}
    \end{equation}
\end{description}

Steps 1 and 2 can be used to compute the total tidal contribution, including 
the time independent (permanent) contribution to the geopotential coefficient 
$\bar{C}_{20}$, which is adequate for a ``conventional tide free'' model. 
When using a ``zero tide'' model, this permanent part should not be counted 
twice.

\begin{figure}
  \centering
  \includegraphics[height=.4\textheight,keepaspectratio]{04solidEarthTide_icrf}
  \caption{Acceleration due to solid Earth tide computed on a one-day arc of \gls{grace}.}
  \label{fig:04solidEarthTide-icrf}
\end{figure}

\paragraph{Implementation \& Validation}\label{par:solid-earth-acceleration-implementation}
The above described procedure was implemented in the software build for this Thesis. 
It is clear from the above, that the computations involved are rather complicated and 
cumbersome; the problem is further perplexed by the fact that the magnitude of the 
computed geopotential coefficient corrections is very small, while computations 
involve values spanning a wide range of orders of magnitude, thus making the computations 
susceptible to round-off errors.

To test the implementation developed for this Thesis, results were checked against the \texttt{COST-G} 
benchmark test. Input data for the test is a one-day orbit arc of \gls{grace} 
along with the Sun and Moon ephemerides, extracted from \texttt{DE 421}. 
The discrepancies between our implementation and the benchmark test are depicted in 
\autoref{fig:costg-benchmark-04solidEarthTide-icrf} and \autoref{table:costg-benchmark-04solidEarthTide-icrf}. 
It should be noted here that the benchmark test considered, involves a number of steps in 
which different software implementations can produce slightly different results, 
as are e.g. computation of Sun and Moon position, handling of datetimes and \gls{icrf}-to-
\gls{itrf} transformations.

\begin{figure}
  \centering
  \includegraphics[height=.4\textheight,keepaspectratio]{04solidEarthTide_icrfVsCostg}
  \caption{Discrepancies with the \texttt{COST-G} benchmark test for the acceleration 
    due to solid Earth tide, computed on a one-day arc of \gls{grace}.}
  \label{fig:costg-benchmark-04solidEarthTide-icrf}
\end{figure}

\begin{table}[]
  \centering
  \begin{tabular}{ccccc}
      %\hline
      \textbf{Component} & \textbf{Min} & \textbf{Max} & \textbf{Mean} & \textbf{Std. Deviation}\\
      & \multicolumn{4}{c}{\si{\metre\per\square\second}} \\
      \hline
      $\ddot{x}$ & -5.36e-13 & +5.45e-13 &  3.51e+00 & 2.71e-13 \\
      $\ddot{y}$ & -5.56e-13 & +5.56e-13 & -4.58e+00 & 3.39e-13 \\
      $\ddot{z}$ & -5.43e-13 & +5.47e-13 & -9.51e-01 & 3.39e-13 \\
      \hline
  \end{tabular}
  \caption{Earth tide acceleration discrepancies against the \texttt{COST-G} benchmark test.}
  \label{table:costg-benchmark-04solidEarthTide-icrf}
\end{table}
