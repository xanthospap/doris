\subsection{Terrestrial to Celestial Transformation}\label{ssec:itrs-to-gcrs}

The definition of the \gls{gcrs} and \gls{itrs} and the procedures for the \gls{itrs} 
to \gls{gcrs} transformation that are provided in this section comply with the 
\gls{iau} 2000/2006 resolutions (see \cite{Capitaine2006} and \cite{iauWGnfa}). 
It should be noted that this section is not an extensive study or presentation 
of the concepts and models involved to relate terrestrial and celestial reference 
systems (and/or frames). It is rather meant to act as a guideline for the work 
performed in the framework of the current Thesis, centered on the design patterns, 
algorithms and methodologies adopted for the implementation of relevant software.

The transformation used to relate the \gls{itrs} to the \gls{gcrs} at the date $t$ 
of an observation can be written as (\cite{iers2010})
\begin{equation}\label{eq:iers1051}
    \bm{r}_{gcrs} = \bm{Q}(t) \bm{R}(t) \bm{W}(t) \bm{r}_{itrs}
\end{equation}
where
\begin{description}
    \item $\bm{Q}(t)$ is the transformation matrix due to the motion of 
        the celestial pole in the celestial reference system 
    \item $\bm{R}(t)$ is the transformation matrix due to the rotation 
        of the Earth around the axis associated with the pole, and
    \item $\bm{W}(t)$ is the transformation matrix due to polar motion
    \item $t$ is the time parameter in the \gls{tt} time-scale, and given by:
    \begin{equation}
        t = (\text{TT} - \text{2000 January 1d 12h TT}) \si{\day} / 36525
    \end{equation}
    involving J2000.0, defined at the geocenter and at the date 2000 January 1.5 TT 
    = Julian Date 2451545.0 TT.
\end{description}
Note that \autoref{eq:iers1051} uses the theoretical formulation of a reference ``system''. 
In reality, it should be clear that the numerical implementation of this formula 
involves the \gls{iau}/\gls{iugg} adopted realization of those reference systems, i.e. 
the \gls{itrf} and \gls{icrf}.

\autoref{eq:iers1051} can be implemented in two distinct procedures, differing only on the 
adopted origin of the \gls{cip} equator, i.e. either using the equinox, thus resulting 
in an \emph{equinox based} transformation, or the \gls{cio}, which in turn results in 
the so-called \emph{CIO based} transformation. In both cases, the matrix $\bm{W}(t)$ is 
identical, while $\bm{Q}(t)$ and $\bm{R}(t)$ will differ. The CIO based
procedure, contrary to the equinox based, is in agreement with \gls{iau} 2000 Resolution B1.8, 
which:
\begin{displayquote}
requires the use of the ``non-rotating origin'' in both the \gls{gcrs} and the 
\gls{itrs} as well as the position of the \gls{cip} in the \gls{gcrs} and in the 
\gls{itrs} 
\end{displayquote}
(\cite{iers2010}). Hence, for this Thesis we have adopted the \emph{CIO based} 
implementation of the transformation \autoref{eq:iers1051}.

Schematically, the \gls{cio}-based procedure, implies (see also \autoref{fig:itrf-to-icrf}):
\begin{itemize}
    \item realization of the \gls{tirs} via applying matrix $\bm{W}(t)$ on an \gls{itrs} 
        vector $\bm{r}$; the \gls{tirs} uses the \gls{cip} as its $z$-axis and the 
        \gls{tio} as its $x$-axis
    \item realization of the \gls{cirs}, that uses the \gls{cip} as its $z$-axis and the 
        \gls{cio} as its $x$-axis, via the rotation matrix $\bm{R}$ with the \gls{era} 
        as its argument, and the matrix $\bm{Q}$ using the two coordinates of the \gls{cip}
        \footnote{The position of the \gls{cip} both in the \gls{itrs} and \gls{gcrs} is 
        provided by the $x$ and $y$ components of the \gls{cip} unit vector.
        These components are called ``coordinates'', and their numerical expressions 
        are multiplied by the factor $\ang{;;129600000}/2 \pi$ in order to represent the 
        approximate values in arcseconds of the corresponding ``angles'' (strictly 
        their sines) with respect to the $z$-axis of the reference system (\cite{iers2010}).}
\end{itemize}

\begin{figure}
  \centering
  \input{tikz/bcrs-itrs}
  \caption{Schematic representation of the ``\gls{cio}-based'' procedure to 
    transform between the \gls{gcrs} and \gls{itrs}.}
  \label{fig:itrf-to-icrf}
\end{figure}

\paragraph{Polar Motion Matrix $W(t)$}\label{par:polar-motion-matrix}
The rotation of the Earth is represented by the diurnal rotation around a
reference axis, called the \gls{cip}. The \gls{cip} does not coincide with 
the axis of figure of the Earth, but slowly moves (in a terrestrial reference 
frame) (\cite{Urban2013}). This motion of the terrestrial reference frame 
with respect to the \gls{cip} is known as \emph{polar motion}. Note that the 
\gls{cip} is not the instantaneous axis of rotation but the axis around which the 
diurnal rotation of earth is applied (in the celestial to terrestrial 
transformation). Polar motion is typically determined from \gls{vlbi} 
observation, as except from the principal periods of 365 days (annual wobble) 
and 428 days (Chandler wobble), it is also affected by unpredictable geophysical 
forces.

According to IAU 2006 Resolution B2, the system at date $t$ as realized 
from the \gls{itrs} by applying the transformation $\bm{W}(t)$ is the 
\gls{tirs}. It uses the \gls{cip} as its $z$-axis and the \gls{tio} as 
its $x$-axis (\cite{iers2010}). This matrix gives the position of the 
terrestrial reference frame with respect to the \gls{tio}.

The $\bm{W}$ matrix can be expressed as (\cite{iers2010}):
\begin{equation}
    \bm{W}(t) = \bm{R}_z(-s') \cdot \bm{R}_y(x_p) \cdot \bm{R}(y_p)
    \label{eq:iers1053}
\end{equation}
where $s'$ is the ``\gls{tio} locator'' and $x_p$, $y_p$ are the 
``polar coordinates'' of the \gls{cip} in the \gls{itrs}. The latter values, 
if not estimated, should be the ones published by the \gls{iers}, corrected for 
the effect of ocean tides and forced terms (aka ``libration''), with periods 
less than two days in space (\cite{iers2010}), see \autoref{ssec:eop-interpolation}.

The \gls{tio} locator $s'$, positioning the \gls{tio} on the equator of the \gls{cip}, 
is necessary to provide an exact realization of the ``instantaneous prime meridian'', 
designated by ``\gls{tio} meridian'' (\cite{iers2010}). $s'$ is obtained from 
polar motion observations by numerical integration, and so is in essence 
unpredictable. However, it is dominated by a secular drift of about 
\SI{47}{\micro\larcsecond\per\century}. The latter is used to actually compute 
$s'$ in \autoref{eq:iers1053}.
%\footnote{In accordance to the \gls{sofa} (\cite{SOFA20210125}) supplied \texttt{iauSp00} function} 
using the function:
\begin{equation}
  s' = \SI{-47}{\micro\larcsecond} \cdot t
  \label{eq:iers10513}
\end{equation}
obtained from C04 data (\cite{Lambert2002}).

%The $\bm{W}(t)$ matrix is computed using a variant of the \gls{sofa} (\cite{SOFA20210125}) 
%supplied \texttt{iauPom00} function.

\paragraph{Earth Rotation Matrix $R(t)$}\label{par:earth-rotation-matrix}
The rotation of the Earth around the axis of the \gls{cip} (i.e. relating 
\gls{tirs} and \gls{cirs}), can be expressed as (\cite{iers2010}):
\begin{equation}
  \bm{R}(t) = \bm{R}_z (-ERA)
  \label{eq:iers1055}
\end{equation}
where $ERA$ is the \gls{era} between the \gls{cio} and the \gls{tio} 
at date $t$ on the equator of the \gls{cip}, which is the rigorous definition 
of the sidereal rotation of the Earth. Working with respect to the \gls{cio} 
(rather than the equinox) sweeps away sidereal time's complexities and opportunities 
for error. The Earth rotation angle, the \gls{cio} based counterpart of \gls{gst},
is simply a conventional linear transformation of \gls{ut1} (\cite{sofa_18141_eacb}):
\begin{equation}
  \label{eq:iers10515}
  \begin{split}
    ERA(T_u) = 2 \pi & ( \text{UT1 Julian day fraction } \\
                     & + 0.7790572732640 + 0.00273781191135448 \cdot T_u )
    \end{split}
\end{equation}
where $T_u = \left( \text{Julian UT1 date } - 2451545.0 \right)$ and 
$UT1=UTC+(UT1-UTC)$. 

Similarly to polar motion, additional components should 
be added to the values published by \gls{iers} for $\Delta UT$ to account for 
the effects of ocean tides and libration, see \autoref{ssec:eop-interpolation}. 

\paragraph{Celestial Motion Matrix $Q(t)$}\label{par:celestial-motion-matrix}
The \gls{cio} based transformation matrix arising from the motion of the \gls{cip} 
in the \gls{gcrs} (i.e. relating \gls{cirs} and \gls{gcrs}), can be expressed as
(\cite{iers2010}):
\begin{equation}
  \bm{Q}(t) = \bm{R}_z (-E) \cdot 
              \bm{R}_y (-d) \cdot 
              \bm{R}_z (E) \cdot 
              \bm{R}_Z (s)
  \label{eq:iers1056}
\end{equation}
where $s$ is the ``\gls{cio} locator'' and $E$ and $d$ being such that the 
coordinates of the \gls{cip} in the \gls{gcrs} are:
\begin{equation}
  \begin{aligned}
    X & = \sin{d} \cos{E} \\
    Y & = \sin{d} \sin{E} \\
    Z & = \cos{d}
  \end{aligned}
\end{equation}
\autoref{eq:iers1056} can be given in an equivalent form directly involving $X$ and 
$Y$ as (\cite{iers2010}):
\begin{equation}
  \bm{Q}(t) = \begin{pmatrix}
    1-\alpha X^2 & -\alpha XY & X \\
    -\alpha XY & 1-\alpha Y^2 & Y \\
    -X & -Y & 1-\alpha (X^2 + Y^2) \end{pmatrix}
    \cdot \bm{R}_Z (s)
    \label{eq:iers10510}
\end{equation}
with $\alpha = 1/(1+\cos{d})$ , which can also be written, with an accuracy of 
\SI{1}{\micro\larcsecond} as $\alpha = 1/2 + 1/8(X^2 + Y^2)$.

$X$ and $Y$ coordinates can be given by developments as function of time in the 
\si{\micro\larcsecond} level, based on the IAU 2006 precession and IAU 2000A
nutation (\cite{CapitaineAndWallace2006}).
%\footnote{Implemented in the \gls{sofa} (\cite{SOFA20210125}) supplied \texttt{iauXy06} function.}
The IAU 2006/2000A developments are as follows (\cite{iers2010}):
\begin{equation}
  \label{eq:tn36516a}
  \begin{aligned}
  X &= \SI{-0.01661700}{\arcsecond} + \SI{2004.19189800}{\arcsecond} t - \SI{0.429782900}{\arcsecond} t^2 \\
  &- \SI{0.1986183400}{\arcsecond}t^3 + \SI{0.00000757800}{\arcsecond} t^4 + \SI{0.000005928500}{\arcsecond} t^5 \\
  &+ \sum_{i} \left[ (a_{s,0})_i \sin \theta + (a_{c,0})_i \cos \theta \right] \\ 
  &+ \sum_{i} \left[ (a_{s,1})_i t \sin \theta + (a_{c,1})_i t \cos \theta \right] \\ 
  &+ \sum_{i} \left[ (a_{s,2})_i t^2 \sin \theta + (a_{c,2})_i t^2 \cos \theta \right] \\ 
  &+ \cdots \\
  \end{aligned}
\end{equation}
and
\begin{equation}
  \label{eq:tn36516b}
  \begin{aligned}
  Y &= -\SI{0.00695100}{\arcsecond} - \SI{0.02589600}{\arcsecond} t - \SI{22.407274700}{\arcsecond} t^2 \\
  &+ \SI{0.0019005900}{\arcsecond} t^3 + \SI{0.00111252600}{\arcsecond} t^4 + \SI{0.000000135800}{\arcsecond} t^5 \\
  &+ \sum_{i} \left[ (b_{s,0})_i \sin \theta     + (b_{c,0})_i \cos \theta \right] \\ 
  &+ \sum_{i} \left[ (b_{s,1})_i t \sin \theta   + (b_{c,1})_i t \cos \theta \right] \\ 
  &+ \sum_{i} \left[ (b_{s,2})_i t^2 \sin \theta + (b_{c,2})_i t^2 \cos \theta \right] \\ 
  &+ \cdots \\
  \end{aligned}
\end{equation}

where $\theta$ is a function of the fundamental lunisolar and planetary arguments.
Further information and computation formulas for the fundamental arguments, 
can be found in \cite{iers2010}, e.g. Chapter 5.7. Complete 
list of coefficients for \autoref{eq:tn36516a} and \autoref{eq:tn36516b} is provided 
by \gls{iers}. 

\gls{vlbi} observations have shown that there are deficiencies in the 
IAU 2006/2000A precession-nutation model of the order of \SI{0.2}{\milli\larcsecond}, 
mainly due to the fact that the free core nutation (\gls{fcn}) is not part of 
the model, \gls{iers} publish observed estimates of the corrections to the 
IAU precession-nutation model. The observed differences with respect to the 
conventional celestial pole position defined by the models are monitored and 
reported by the \gls{iers}as ``celestial pole offsets''. Such time-dependent 
offsets from the direction of the pole of the \gls{gcrs} must be provided as 
corrections $\delta X$ and $\delta Y$ to the $X$ and $Y$ coordinates (\cite{iers2010}).
Using these offsets, the corrected celestial position of the \gls{cip} is 
given by (\cite{iers2010}):
\begin{equation}
  \begin{aligned}
    X = X_{\text{IAU 2006/2000}} + \delta X \\
    Y = Y_{\text{IAU 2006/2000}} + \delta Y
  \end{aligned}
\end{equation}
thus enabling to re-write \autoref{eq:iers10510} as:
\begin{equation}
  \bm{\tilde{Q}}(t) = \begin{pmatrix}
    1 & 0 & \delta X \\
    0 & 1 & \delta Y \\
    -\delta X & -\delta Y & 1
    \end{pmatrix}
    \cdot \bm{Q}_{IAU}
    \label{eq:iers10527}
\end{equation}
where $\bm{Q}_{IAU}$ represents the $\bm{Q}(t)$ matrix based on the IAU 2006/2000 
precession-nutation model.

The ``\gls{cio} locator'' $s$, providing the position of the \gls{cio} in the 
\gls{gcrs} can also be computed using a development described in \cite{Capitaineetal2003a}.
%\footnote{\gls{sofa} (\cite{SOFA20210125}) supplies an implementation of the formula named \texttt{iauS06} function}.
