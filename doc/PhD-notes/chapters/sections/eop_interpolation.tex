\subsection{\gls{eop} Information And Interpolation}\label{ssec:eop-interpolation}

\Gls{eop} information for formulating the Celestial-to-Terrestrial transformation 
matrix, is extracted from the \gls{iers} \texttt{C04} files (\cite{Bizouard2019}).
These files contain tabulated \gls{eop} values ($x_p$, $y_p$, $\delta UT1$, $LOD$ and 
the celestial pole offsets $\delta X$ and $\delta Y$) at 0\textsuperscript{h} \gls{utc}. 
$LOD$ and celestial pole offsets contain the most dramatic variation over time, while 
the pole coordinates and time offset parameters exhibit much smoother variations.

In general, the tabulated pole coordinates, $\delta UT1$ and $LOD$ values must first 
be interpolated to the appropriate time and then corrected for ocean tide and 
libration effects. The ocean tide corrections, include diurnal and semi-diurnal 
variations caused by ocean tides for polar motion, $\delta UT1$ and $LOD$. Libration effects, 
include diurnal and semi-diurnal nutations that originate from the direct effect 
of the external (mainly luni-solar) torque on the non-axisymmetric part of the Earth 
(\cite{iers2010} and references therein) and like ocean tide corrections, have an effect on 
pole coordinates as well as $\delta UT1$ and $LOD$. The variations of these effects 
have to be accounted for when using the published values for \gls{eop} parameters.

Especially for $\delta UT1$ and $LOD$, according to \cite{Bradley2016}, 
prior to their interpolation, ``the tabulated values should be smoothed through regularization 
to enhance the interpolation accuracy''. Regularization is the removal of zonal tidal 
variations with frequencies ranging from 5 days to 18.6 years. This ``regularization'' is 
implemented in the \gls{eop} interpolation process.

For the current Thesis, the process described above was designed and implemented, for 
extracting \gls{eop} information from \texttt{C04} files, storing values in efficiently designed 
data structures, and performing the interpolation along with the corrections described above.
A schematic representation is given in \autoref{fig:handling-eop}. As shown in 
\autoref{fig:eop-interpolation-results}, including the ocean tide and libration 
effects, allows for the introduction of diurnal and semi-diurnal signals.

\begin{figure}
  \centering
  \includegraphics[height=.4\textheight,keepaspectratio]{eop_interpolation}
  \caption{Interpolation of \gls{eop} parameters $x_p$, $y_p$, $\delta UT1$ and $LOD$ 
      performed by the software developed, following \ref{fig:handling-eop}. Red crosses 
      represent the input, reference \gls{eop} values.}
  \label{fig:eop-interpolation-results}
\end{figure}

For the polar motion \gls{eop}, $x_p$ and $y_p$,
\begin{equation}
    \begin{pmatrix} x_p & y_p \end{pmatrix} = 
    \begin{pmatrix} x & y \end{pmatrix}_{IERS} + 
    \begin{pmatrix} \Delta x & \Delta y \end{pmatrix}_{ocean\text{ }tides} + 
    \begin{pmatrix} \Delta x & \Delta y \end{pmatrix}_{libration} 
\end{equation}
where $\begin{pmatrix} \Delta x & \Delta y \end{pmatrix}_{ocean\text{ }tides}$ 
and $\begin{pmatrix} \Delta x & \Delta y \end{pmatrix}_{libration}$ are computed as 
outlined in \cite{iers2010}; the former is achieved by a software routine designed 
on the basis of the \texttt{ORTHO\_EOP}\footnote{Available from the \gls{iers} \href{https://iers-conventions.obspm.fr/}{Conventions Centre} at \url{https://iers-conventions.obspm.fr/content/chapter8/software/ORTHO_EOP.F}, provided by R. Eanes.\label{fn:ortho-eop-f}} 
to compute the diurnal and semidiurnal variations in the Earth orientation, while the latter 
is based on \texttt{PMSDNUT2}\footnote{Available from the \gls{iers} \href{https://iers-conventions.obspm.fr/}{Conventions Centre} at \url{https://iers-conventions.obspm.fr/content/chapter5/software/PMSDNUT2.F}, provided by A. Brzezinski. \label{fn:pmsdnut2-f}}
to compute the diurnal lunisolar effect on polar motion, see \autoref{fig:handling-eop}.

Similarly, for the $\delta UT1$ and $LOD$ values, 
\begin{equation}
    \begin{pmatrix} \delta UT1 & LOD \end{pmatrix} = 
    \begin{pmatrix} x & y \end{pmatrix}_{IERS} + 
    \begin{pmatrix} \delta UT1 & LOD  \end{pmatrix}_{ocean\text{ }tides} + 
    \begin{pmatrix} \delta UT1 & LOD  \end{pmatrix}_{libration} 
\end{equation}
where again $\begin{pmatrix} \delta UT1 & LOD  \end{pmatrix}_{ocean\text{ }tides}$ 
are computed using the same procedure as above, while $\begin{pmatrix} \delta UT1 & LOD  \end{pmatrix}_{libration}$ 
are computed using a software routine designed on the basis of the \gls{iers}-published 
\texttt{UTLIBR}\footnote{Available from the \gls{iers} \href{https://iers-conventions.obspm.fr/}{Conventions Centre} at \url{https://iers-conventions.obspm.fr/content/chapter5/software/UTLIBR.F}, provided by A. Brzezinski.\label{fn:utlibr-f}} 
to account for the subdiurnal librations.

The linear interpolation is based on a Lagrangian interpolation scheme, generic enough to 
perform interpolation of any order (given enough data). For \gls{pod}, a 5-order 
interpolation procedure is performed, based on results from \cite{Bradley2016}. 

Optionally, users can perform the ``regularization'' of $\delta UT1$ and $LOD$ values. 
In this case, prior to the interpolation the tabulated values are smoothed through 
regularization to enhance the interpolation accuracy. After regularization and 
interpolation, the zonal tide value should be added back at the time of interpolation.
At this point, the ocean tide corrections should be computed and added to the 
interpolated values. The zonal tide effects are based on models recommended by 
the \gls{iers} Conventions and the distributed \texttt{RG\_ZONT2}
%\footnote{Available from the \gls{iers} \href{https://iers-conventions.obspm.fr/}{Conventions Centre} at 
%\url{https://iers-conventions.obspm.fr/content/chapter5/software/PMSDNUT2.F}, provided by A. Brzezinski. \label{fn:rg-zont2-f}}.

%\begin{table}
%\centering
%\begin{tabular}{|p{3cm}|p{3cm}|p{2.5cm}|p{5cm}|}
%    \hline
%    \textbf{Function/Data Structure} & \textbf{Header File} & \textbf{Repository/ Library} & \textbf{Comment} \\
%    \hline
%    \texttt{EopLookUpTable} & \texttt{eop.hpp} & \texttt{doris} & 
%    Contains all relevant declerations, data structures and algorithms to handle 
%    \gls{eop} information. \\
%
%    \hline
%    \texttt{parse\_iers\_C04} & \texttt{eop.hpp} & \texttt{doris} & \\
%
%    \hline
%    \texttt{ortho\_eop} & \texttt{iers2010.hpp} & \texttt{iers2010} &
%    compute the diurnal and semidiurnal variations in \gls{eop} ($x$,$y$, $UT1$) from
%    ocean tides; translated from \texttt{ORTHO\_EOP.F} \footref{fn:ortho-eop-f} \\
%
%    \hline
%    \texttt{pmsdnut2} & \texttt{iers2010.hpp} & \texttt{iers2010} &
%    evaluate the model of polar motion for a nonrigid Earth due to tidal gravitation; 
%    translated from \texttt{PMSDNUT2.F} \footref{fn:pmsdnut2-f} \\ 
%
%    \hline
%    \texttt{utlibr} & \texttt{iers2010.hpp} & \texttt{iers2010} & 
%    compute subdiurnal libration in the axial component of rotation, expressed by 
%    \gls{ut1} and LOD. This effect is due to the influence of tidal gravitation on the
%    departures of the Earth's mass distribution from the rotational
%    symmetry, expressed by the non-zonal components of geopotential. Translated 
%    from \texttt{UTLIBR.F} \footref{fn:utlibr-f} \\
%
%    \hline
%    \texttt{interp\_pole} (and \texttt{interp} namespace) & \texttt{iers2010.hpp} & \texttt{iers2010} & 
%    account for ocean tidal and libration effects in \gls{eop}; translated from \texttt{INTERP.F} \footref{fn:interp-f}\\
%
%    \hline
%\end{tabular}
%\caption{List of functions and data structures relevant to handling \gls{eop} information.}
%\label{table:eop-handling-fds}
%\end{table}


\begin{figure}
\centering
\input{tikz/handling_eop.tex}
\caption{Extracting \gls{eop} information from \gls{iers} \texttt{C04} data files.}
\label{fig:handling-eop}
\end{figure}
