\subsection{Review and Motivation}\label{ssec:review-and-motvation}

Geodesy has greatly advanced since the introduction of artificial, Earth orbiting 
satellites. A new era has emerged, where satellite-based data dominate the field, 
providing results for a wide range of geodesy-related fields, including but not 
limited to positioning, reference frames, altimetry and gravity field determination. 
Nowadays, space geodetic techniques, provide a unique opportunity to monitor and, 
therefore, understand the processes and feedback mechanisms of the Earth 
system with unparalleled precision and resolution.
\iffalse (\cite{Jin2013}). \fi

The use of artificial satellites in geosciences has some prerequisites though; 
these are basically a comprehensive knowledge of the satellite motion under 
the influence of all acting forces as well as the description of the satellite
trajectory and ground stations in suitable reference frames, both spatial and 
temporal. Thus exploitation of satellite-based observations is inherently 
coupled with the complex problem of orbit determination, a problem that lies in 
the core of satellite geodesy since its inception.

Satellite orbit determination is the process by which knowledge of the satellite’s
motion relative to the center of mass of the Earth in a specified coordinate 
system can be obtained (\cite{Tapley2004}). Its contribution can be broadly
grouped in a twofold role:
\begin{description}
    \item[As a product] (i.e. tabulated satellite coordinates and/or velocity) 
    it is needed for most spaced-based applications. Knowledge of satellite 
    position (or state) is a prerequisite for most applications and in general 
    dictates the quality of the application's outcome. It should be noted that 
    despite the extended demand for accurate satellite coordinates in recent 
    years (mainly due to \gls{gnss}), the product list is by no means exhausted here; 
    several other estimates constitute orbit determination products, as are e.g. 
    earth orientation parameters, crucial for reference frame studies.
    \item[As a field of study], it enables the testing, validation and improvement 
    of models and theoretical aspects for various scientific disciplines, 
    geodesy being the first and foremost beneficiary.
\end{description}

Orbit determination is by no means a homogeneous, non-deviating pattern; satellite 
dynamics, orbit characteristics, parameter quality and product latency as well 
as observation method/system, all play a significant role in making key strategic 
choices. On top of that, one must make optimal decisions between models and
methodologies, design and implementation, in an ever-upgrading, multi-discipline 
field.

To-date, \gls{pod} is dominated by three space geodetic techniques, namely \gls{slr}, \gls{gnss} and
\gls{doris}, which additionally, via the corresponding Technique Centers, provide the input
data time series of station positions and \gls{eop} for the realization of the \gls{itrf}
\footnote{ITRF2020, \url{https://itrf.ign.fr/en/solutions/ITRF2020}}. Along with \gls{vlbi}, these
techniques constitute the fundamental pillars of modern satellite geodesy.

\gls{doris} is a technique whereby satellites receive the broadcasted signal 
transmitted by ground beacons. Using the measured Doppler shift, \gls{doris} 
can accurately determine the orbit of the satellite, Earth rotation and 
station coordinates that can be used in different geodetic applications (e.g. \cite{Lemoine2016}, \cite{Gambis2006} and \cite{Kur2022}).
State-of-the-art \gls{pod} analysis, can deliver accuracies in the 
centimeter level in the radial direction (\cite{Rudenko2023}).

\gls{doris} has played a crucial role in expanding geodetic knowledge and enhancing
our understanding of the Earth's dynamics since its introduction in the late 1980s.
The technique is anticipated to continue to enhance its significant role in the field
of satellite geodesy through endeavors such as the Surface Water and Ocean Topography
(SWOT) and GENERIS missions. The SWOT mission, launched in December 2022, aims to carry
out the
first-ever global survey of Earth's surface water (\cite{Biancamaria2016}). Additionally,
the GENESIS platform, employing "space-ties," is expected to solve inconsistencies and
biases between different geodetic techniques, ultimately improving TRF accuracy and
stability (\cite{Delva2023}).

\iffalse
Since its introduction in the late 1980s, \gls{doris} has played a crucial role 
in expanding geodetic knowledge and enhancing our understanding of the Earth’s 
dynamics. The technique is expected to further enhance its key role within the 
field of satellite geodesy, via e.g. the Surface Water and Ocean Topography (SWOT) 
mission (launched in December 2022), designed to make the first-ever global 
survey of Earth's surface water (\cite{Biancamaria2016}) and The GENESIS platform, 
which using ``space-ties'' is expected to solve the inconsistencies and biases 
between the different geodetic techniques, thus improving TRF accuracy and stability 
(\cite{Delva2023}).

By virtue of the ever increasing accuracy achieved by geodesy and related fields, 
the growing number of satellite missions and the constant widening of application 
range and user community, \gls{pod} 
\fi

\subsection{Problem Statement and Objective}\label{ssec:statement-and-objective}

Despite the \gls{doris} prominence and significance in the field of satellite geodesy,
it has failed to allure a dedicated scientific audience comparable in size to 
the other two techniques. For the most recent realization of \gls{itrf}, the 
\gls{ilrs} contributed data from 7 Analysis Centers (\cite{Pavlis2023}), \gls{igs} 
from 10 (\cite{Rebischung2021}), while at the same time the \gls{ids}'s contribution 
was derived from only 4 Analysis Centers (\cite{Moreaux2022}). This shortage of 
dedicated \gls{ids} analysis centers,
\iffalse
also reflects the scarcity in dedicated
software tools to process \gls{doris} data, first and foremost for orbit 
determination. \fi
is indicative of the limited availability of dedicated software solutions designed to handle DORIS data, particularly for the purpose of orbit determination.

\gls{pod} is a very challenging task, requiring multi-scientific expertise,
coupled with efficient engineering. Building a software tool to perform \gls{pod} 
matching the highest accuracy levels assumes expertise, a dedicated scientific 
group and years of development. Most, if not all, of the currently available 
software packages to perform \gls{pod} using \gls{doris} data (e.g. GEODYN (\cite{Geodyn2015}, 
GINS (\cite{Gins2013}) and Bernese (\cite{Stepanek2010})) have evolved over
decades of continuous development. Important issues though come into play:
\begin{itemize}
  \item These packages are either not free and/or not open souce; hence it is not 
    easy, if possible at all, for the scientific community to use them.
  \item They are not easily adaptable and/or extensible to meet user needs (e.g. due 
    to not being open source, or due to their sheer codebase size).
  \item They do not comply with modern programming patterns and paradigms. Maturity 
    often comes at a price, and in this case this is having to comply with legacy 
    codebase.
\end{itemize}

In the framework of the current Thesis, the scarcity of dedicated \gls{doris}
analysis tools for orbit determination is targeted, with the aim of creating
a high quality, scientific software solution. Designing for extensibility, 
reusability and adaptability, and adhering to a free and open source policy, an 
as large as possible impact is sought for in the scientific community. Coupled 
with recent advancements in the technique (e.g. adoption of the RINEX format, 
dissemination of non-preprocessed data including carrier phase observables, 
introduction of next generation receivers and beacons) all of which are 
incorporated in the software built, we hope to spur further, renewed interest 
in this fundamental area of satellite geodesy.

\iffalse
Due to the complexity of the problem and the limitations inherent in a Thesis 
(both in time and resources), the objective of the current study is not to match 
the highest possible accuracy, currently delivered by the \gls{ids} Analysis 
Centers. However, the aim is to built a brand new toolset, from scratch, to act as 
a building block towards this end. A toolset that augmented with some fine 
refinements can be the backbone of a state-of-the-art, \gls{doris} \gls{pod} 
analysis pipeline.
\fi
Given the complexity of the problem and the inherent limitations of a thesis, both in
terms of time and resources, the objective of the current study is not to attain the
highest possible accuracy achievable by the \gls{ids} Analysis Centers. Instead, the
focus is on developing a brand-new toolset from scratch, which can serve as a
foundational component towards achieving that goal. The envisioned toolset, with
some additional fine refinements, has the potential to form the backbone of a
state-of-the-art, \gls{doris} \gls{pod} analysis pipeline.

Since \gls{doris} receivers are on-board \gls{leo} satellites (e.g. altimetry 
oriented missions), focus is placed in implementing models and methodologies 
targeted towards \gls{leo} satellites. However, care is taken to not place 
unneeded constraints on the software, so that later enhancements can easily 
broaden the application range to other trajectories.

Furthermore, the software should be designed in a manner that could easily 
accommodate a near-real-time processing scheme, since it is currently possible to 
to acquire \gls{doris} data with a latency of a few hours\footnote{\gls{ids} Working Group ``NRT DORIS data'' \url{https://ids-doris.org/organization/working-group-nrt-doris-data.html}} (see e.g. \cite{Wang2022}).
Hence, algorithmic design and implementation, as well as efficiency and resource 
awareness are all topics to be considered.

\iffalse
This thesis is a study of orbit determination for \gls{leo} satellites, using the \gls{doris}
The aim is a robust methodology, providing
quality satellite state estimates, one though that can be efficient enough to be implemented for near-real time
applications. Hence, algorithmic design and implementation, as well as efficiency and resource awareness are all
topics to be considered. This thesis took place under a frame of an ambitious, nearly over optimistic goal, for
Dionysos Satellite Observatory to develop an orbit determination tool of its own; with this thesis, the groundwork
is more than laid. At international level, only a handful of such high-quality software tools exist, developed and
used by high caliber renowned institutions, with critical impact in the field of geodetic studies.
Guidelines set by the \gls{ids} act as the de-facto standard for orbit determination
via \gls{doris}. In this thesis we try to comply with this set of recommendations as close as possible, deviating when
needed to check and validate alternate or novel processing approaches.
\fi

\subsection{Methodology and Implementation}\label{ssec:methodology}

To accomplish the Thesis objectives, a brand new software toolset was designed and 
implemented from scratch. The software is built in a modular fashion. The various components
are organized in different, independent, moderate-sized libraries, targeting well defined
problems. This scheme allows for extensive and thorough testing and validation  of the different 
parts of the package, a vital part of modern software design (e.g. \cite{Oberkampf2010}, \cite{Meyer2008}).
Additionally, it enables customization according to user needs and accommodates  
extensibility and maintainability.
\iffalse
The latter attributes are of major importance when
aiming at an analysis tool reaching \gls{ids} accuracy demands, since such software packages 
are in an ever-lasting cycle of adopting the latest, most up-to-date scientific advancements.
\fi
The aforementioned attributes are crucial when targeting an analysis tool that meets the
demanding accuracy requirements of \gls{ids}, as such software packages are constantly
evolving to incorporate the most recent and cutting-edge scientific advancements.

\iffalse
Practically, this design enables the creation of simple, customizable, easy to
reason about, application-targeted source code to handle the problem at hand, without 
having to be aware of the full codebase complexity.
\fi
In practical terms, this design approach facilitates the development of straightforward,
customizable, and easy to reason about source code, tailored to the specific application
requirements, without necessitating a comprehensive understanding of the entire
codebase's intricacies.
For example, the source code
for orbit determination using daily RINEX files for \gls{jason}-3 presented in 
\autoref{sec:jason3-pod}, is only a few hundreds of lines long. Adapting the scheme 
to process data from a different \gls{leo} satellite would only consist in adding 
the respective macromodel and attitude determination options.

Changing the Earth's gravity model, e.g. for testing or validation purposes, 
would only incur a change in the respective line of the configuration file (given 
that a corresponding data file is available via \gls{icgem}, a condition met 
by all modern models).

State-of-the-art models and methodologies are used, adhering to the latest 
standards and recommendations (e.g. \cite{IdsRecommendationItrf2020}, \cite{iers2010}). 
Extensions and modifications are derived and applied where needed. Various different 
implementations are put to the test and robust algorithmic approaches are constructed 
based on criteria of accuracy and efficiency (computing speed and resources).

%Implementation of such sophisticated and complex models is a challenging task. One that requires a
%rigorous understanding of the theoretical implications on the one hand, and robust
%engineering on the other.
Implementing sophisticated and complex models poses a significant challenge, requiring a
rigorous comprehension of the theoretical implications on one hand, and robust
engineering practices on the other.
The path taken here, is to follow modern software design
patterns, including principles of \emph{data-oriented} design (\cite{Fabian2018}), coupled with 
the well established \emph{object-oriented} pattern, while also taking advantage of 
modern features such as generic programming via \emph{template metaprogramming} 
(e.g. \cite{Gawlik2018}). Given that most scientific software packages were built 
a few decades back, this design constitutes a novel approach in software tools for 
the given problem set.

Multi-threading and parallel processing techniques are used, taking advantage of 
``standard libraries'', hence no external tool is needed, minimizing dependencies, 
third-party limitations and compliance constraints.

Near-real-time processing capabilities are embedded into the software through 
meticulous design. To accommodate such possibility, care is taken during the 
design and implementation phases to proceed in an iterative fashion, and not 
consume any resources further than the ones needed at the current step. Data 
pre-processing requirements are limited down to minimum. Data files, which pose a 
serious challenge due to their size, are incrementally mapped to memory (resembling 
in essence a streaming process) so that only the information relating to the 
current time interval is needed at each step.

\subsection{Significance and Novelties}\label{ssec:significance-and-novelty}
\iffalse
This Thesis touches upon a fundamental problem of satellite geodesy, one that sits 
in the core of using Earth orbiting satellites to study the Earth system, introducing 
on the way novel approaches, and validating state-of-the-art methodologies.
Since, accurate knowledge of satellite position is an essential and imperative need 
for space based application, orbit determination is a problem of utmost significance. 
\fi
This Thesis addresses a fundamental problem in satellite geodesy that is crucial
for utilizing Earth-orbiting satellites to study the Earth system. In doing so, it
introduces novel approaches and validates state-of-the-art methodologies. Accurate
knowledge of satellite position is critical for space-based applications, making
orbit determination a problem of utmost significance.

Building a software tool for a fundamental yet not too popular amongst the 
scientific community technique such as \gls{doris}, the aim is to create a brand new, 
modern toolset, to spur further interest and explore further the system's 
capabilities and limitations. The prominence of the technique is evident by its 
involvement in some of the most ambitious space geodesy missions to come (e.g. 
SWOT and GENESIS), thus dedicated analysis packages will play a major role in 
years to come.

Adopting a free and open-source policy, can create a new, extended, high-expertise 
user base, which in turn will push for further technique enhancements.

Focal points addressed and novelties introduced in this Thesis, are the following:
\begin{itemize}
  \item Processing of the newly established \gls{doris} RINEX data. This new 
   format replaces the older doris.v2.2 file format, enabling the dissemination 
   of new observation types and products. Effort has been made to accommodate 
   the complete parsing of all available observation types. Additionally, linear
  combinations and corresponding antenna reference point eccentricities are 
  (optionally) constructed and used for the formulation of observation equations. 
  This generic design (in which no certain linear combination and reference point 
  is hard-coded within the software) enables user flexibility and accommodates 
  novel processing approaches.
  \item Capability of processing carrier phase measurements (instead of the current 
  practice in which only Doppler counts are used). Currently, this constitutes an 
  experimental approach within the \gls{doris} technique (e.g. \cite{Mercier2010}).
  \item A modern view on software design and software engineering principles applied. 
  This includes the emerging, so called data-oriented design paradigm, usage of 
  generic template metaprogramming techniques, and adoption of well established 
  programming tools in the scientific community, including the \texttt{C++} and 
  \texttt{Python3} programming languages (e.g. also adopted for the development 
  of GipsyX/RTGx, see \cite{Bertiger2020}).
  \item Capacity to process \gls{doris} data in a near-real-time fashion. To the 
  author's best knowledge, no Analysis Center is currently performing near-real-time 
  analysis (except for the operational on-board receiver systems).
  %\item Implementation of home-grown approaches to complex problems and methodologies.
  \item Implementation of in-house strategies and techniques to tackle intricate issues and methodologies.
  Two examples are orbit integration (\autoref{sec:integrator-implementation}), 
  where state-of-the-art methods were adapted and rigorously implemented to fit 
  current needs and computation of Earth's gravity acceleration 
  (\autoref{sssec:gravity-acceleration}), where numeric and analytic derivations were 
  performed to implement an efficient yet accurate computation algorithm.
  \item Adoption of a free and open-source policy, developing source code in the 
  public domain and making it instantly and unambiguously available to any interested 
  party.
\end{itemize}

\subsection{Organization of the Thesis}\label{ssec:organization}
The layout of the Thesis, includes seven chapters.
%In the second chapter (\autoref{ch:fundamental-astrodynamics}), required concepts of
%fundamental astrodynamics are introduced.
The second chapter (\autoref{ch:fundamental-astrodynamics}) serves to introduce
fundamental concepts in astrodynamics that are necessary for understanding the subject
matter.
Perturbed satellite motion is discussed and
state-of-the-art approaches for modeling perturbation forces acting on Earth orbiting
satellites are presented along with implementation details. Spatial and temporal reference
frames are then introduced, to efficiently describe orbital motion.

Chapter three (\autoref{ch:orbit-integration}), provides a comprehensive review on orbit integration
%The next chapter (\autoref{ch:orbit-integration}) reviews orbit integration
, focusing on
numerical integration of orbital motion using the \emph{special perturbations}
approach. An efficient yet robust integrator is derived, to be used in a \gls{pod}
analysis scheme.

In Chapter four (\autoref{ch:pod}), an overview of \gls{pod} concepts is given,
with special attention on the \emph{Extended Kalman Filter} and the linearization
of the (non-linear) perturbed orbital trajectory model. Consequently, efficient
representation and formulation of the \emph{variational equation} system is discussed,
a fundamental yet complex problem for high accuracy orbit determination.

The \gls{doris} technique is introduced in Chapter five (\autoref{ch:doris}).
The technique's principle is presented, along with the instrumentation used and
details on the ground segment, including the tracking network. Derivation of the
observation equation model, theoretical implications, error sources and mitigation are
also discussed. Implementation details and considerations conclude this
chapter.

Chapter six (\autoref{ch:pod-using-doris}) commences by outlining the software developed
specifically for this Thesis. The subsequent sections of the chapter detail the rigorous
testing and validation process undertaken for the tools constructed, utilizing actual \gls{doris}
 data collected during the \gls{jason}-3 satellite mission over a duration of one day.
%Chapter six (\autoref{ch:pod-using-doris}) begins with a description of the
%software built for this Thesis. It then goes on to test and validate the tools built,
%using a real-world scenario with one day of \gls{doris} data acquired from the
%\gls{jason}-3 satellite mission.
Results obtained are checked against high-quality
reference results. Differences with respect to the reference solution are thoroughly
examined and reasoned about.

The last Chapter (\autoref{ch:summary-and-recomend}) of the Thesis discusses
conclusions drawn from the work performed and recommendations for further research
activities and refinements of the software tools built.
