\chapter{Satellite Orbits}
\label{ch:satellite-orbits}

\begin{figure}
\centering
\tdplotsetmaincoords{70}{165}
\input{tikz/orbital_elements_Ooi.tex}
\caption{Orbital Elements $\Omega$, $\omega$ and $i$}
\label{fig:orbital-elements-Ooi}
\end{figure}

\section{Satellite Orbits}
\subsection{Perifocal Coordinate System}
The \emph{perifocal coordinate system} (often designated \emph{PQW}) is 
convinient for processing satellite observations. In general, the frame is 
centered at the focus of the orbit and the unit vectors $\hat{\bm{p}}$ and 
$\hat{\bm{q}}$ lie in the orbital plane; $\hat{\bm{p}}$ is directed towards 
the periapsis while $\hat{\bm{q}}$ has a true anomaly ($v$) of \SI{90}{\degree} 
past the periapsis. The unit vector $\hat{\bm{w}}$ is the angular momentum 
vector $\vec{\bm{h}}$, normal to the orbital plane, such that 
$\hat{\bm{w}} = \hat{\bm{p}} \times \hat{\bm{q}} = \frac{\vec{\bm{h}}}{h}$.

In the case of an Earth-orbiting satellite, the fundamental plane is the 
satellite orbit and the origin is the center of the Earth. The $\hat{\bm{p}}$ 
axis points towards the perigee (see \ref{fig:eccentric-anomaly}). For 
perfectly circular orbits, other recerence systems are prefered due to the 
lack of perigee (\cite{Vallado}).

In the perifocal frame, the position vector $\vec{\bm{r}}$ can be written as:
\begin{equation}
  \vec{\bm{r}} = \bar{x} \hat{\bm{p}} + \bar{y} \hat{\bm{q}}
\end{equation}
where
\begin{equation}
  \begin{aligned}
  \bar{x} &= r \cos v &= \alpha ( \cos E - e ) &\\
  \bar{y} &= r \sin v &= b \sin E              &= \alpha \sqrt{1-e^2} \sin E \\
  \end{aligned}
\end{equation}



\begin{figure}
\centering
\tdplotsetmaincoords{70}{165}
\input{tikz/eccentric-anomaly.tex}
\caption{Perifocal Coordinates}
\label{fig:eccentric-anomaly}
\end{figure}

\section{Geopotential}
For precise orbit determination, we need to drop the assumption of the total mass 
of the Earth being concentrated in the center of the coordinate system. For the
following discussion of a more realistic model is adopted, where it is convenient 
to use an equivalent representation involving the gradient of the corresponding 
gravity potential \(U\)
\begin{equation}
    \ddot{\vec{r}} = \nabla U \textrm{ where } U = G M_{\Earth} \frac{1}{r}
\end{equation}

This expression for the potential may easily be generalized to an arbitrary mass
distribution by summing up the contributions created by individual mass elements
\(dm = \rho(\vec{s}) d^3 \vec{s}\) according to (\cite{Montenbruck2000})
\begin{equation}
    U = G \int{\frac{\rho(\vec{s}) d^3 \vec{s}}{\lvert \vec{r} - \vec{s} \rvert}}
\end{equation}

For computations, the Earth's gravity potential at point \((\phi , \lambda)\) 
can be approximated using a spherical harmonics expansion 
(e.g. \cite{Montenbruck2000})
\begin{equation}
    U = \frac{G M_{\Earth}}{r} \sum_{n=0}^\infty \sum_{m=0}^n 
    \frac{R_{\Earth}^n}{r^n} P_{nm}(sin\phi) 
    (C_{nm} cos(m\lambda) + S_{nm} sin(m\lambda))
\end{equation}

with the coefficients \(C_{nm}\) and \(S_{nm}\) describing the dependence on the 
Earth's internal mass distribution. These coefficients can be extracted from a 
suitable  \emph{geopotential model}.

Note that Geopotential coefficients with \(m=0\) are called  \emph{zonal} coefficients, 
since they describe the part of the potential that does not depend on the longitude. 
All \(S_{n0}\) vanish due to their definition, and the notation \(J_n = -C_{n0}\) 
is commonly used for the remaining zonal terms. The other geopotential coefficients
are known as \emph{tesseral} and \emph{sectorial} coefficients for \(m<n\) and 
\(m = n\), respectively.

\fbox{\begin{minipage}{.9\textwidth}
To compute the acceleration \(\ddot{\vec{r}}\), which is equal to the 
gradient of \(U\), we use the recursion formulas described in \cite{Montenbruck2000}.
Note that these expressions, use the \underline{non-normalized} harmonic 
coefficients. 
\end{minipage}}

\subsection{Gravity Models}
The \href{http://icgem.gfz-potsdam.de/home}{International Centre for Global Earth Models (ICGEM)}  
(\cite{icgempub}) web service hosts a large number of gravity field models, 
published in what is called the \emph{The ICGEM-format}(\cite{ICGEMFormat}). 

Such static model files can be parsed and the respective harmonic coeefficients 
(\(C_{nm}\) and \(S_{nm}\)) be used to compute satellite acceleration induced by 
the geopotential.

\section{Sun and Moon Perturbing Acceleration}
According to Newton's law of gravity, the acceleration of a satellite by a point 
mass \(M\) is given by:
\begin{equation}
    \label{eq:mon335}
    \ddot{\vec{r}} = G M \frac{\vec{s}-\vec{r}}{\lvert \vec{s} - \vec{r} \rvert ^3}
\end{equation}
where \(\vec{r}\) and \(\vec{s}\) are the geocentric coordinates of the satellite 
and of \(M\) respectively. Some care is required, however, before this expression 
can be used for describing the satellite's motion with respect to the center of 
the Earth. The value of \(\ddot{\vec{r}}\) in \ref{eq:mon335} refers to an 
inertial or Newtonian coordinate system in which the Earth is not at rest, but 
is itself subject to an acceleration
\begin{equation}
    \ddot{\vec{r}} = G M \frac{\vec{s}}{\lvert \vec{s} \rvert ^3}
\end{equation}
due to M. Both values have to be subtracted to obtain the second derivative
\begin{equation}
    \label{eq:mon337}
    \ddot{\vec{r}} = G M (\frac{\vec{s}-\vec{r}}{\lvert \vec{s} - \vec{r} \rvert ^3} - \frac{\vec{s}}{\lvert \vec{s} \rvert ^3})
\end{equation}
of the satellite's Earth-centered position vector.

\subsection{Sun, Moon and Planetary Ephemerides}
To use the formula \ref{eq:mon337} we need the (geocentric) coordinates of the 
Sun and Moon. To that end, we can either use low-precision solar and lunar 
coordinates (as described e.g. in \cite{Montenbruck2000} and \cite{Vallado}) or 
use JPL Ephemerides. Both options are available.

\subsubsection{JPL Ephemerides}
Jet Propulsion Laboratory Development Ephemeris (abbreved JPL DE(number), or 
simply DE(number)) designates one of a series of mathematical models of the 
Solar System produced at the \href{https://www.jpl.nasa.gov/}{Jet Propulsion Laboratory} 
for use in spacecraft navigation and astronomy. The models consist of numeric 
representations of positions, velocities and accelerations of major Solar System 
bodies, tabulated at equally spaced intervals of time, covering a specified 
span of years (\cite{wiki-jplde}). Further information and a description of 
vailable ephemerides, can be found at the 
\href{https://ssd.jpl.nasa.gov/planets/eph_export.html}{JPL Planetary and Lunar Ephemerides} website.

We use an interface to the JPL-provided Observation Geometry System
for Space Science Missions (\href{https://naif.jpl.nasa.gov/naif/}{SPICE}) 
software library \footnote{based on the C version of the the 
\href{https://naif.jpl.nasa.gov/naif/toolkit_C.html}{Navigation and Ancillary Information facilty}} 
to extract planet coordinates. 

\section{Atmospheric Drag}
Next to the oblateness of the Earth, atmospheric drag most strongly influences the
motion of a satellite near Earth; in fact, during the last few revolutions of the satellite's
life, drag effects can be more dominant than those from the Earth's oblateness. For more
distant satellites, third-body effects and solar-radiation pressure dominate more than
oblateness and drag (\cite{Vallado}). Atmospheric forces represent the largest 
non-gravitational perturbations acting on low altitude satellites.

The cause of drag is the atmospheric particles, which retard the satellite's motion.
Calculating density is extremely complex for real-world problems.

\subsection{Acceleration Due to Drag}
\label{ssec:acceleration-due-to-drag}
Assuming furthermore that the
atmosphere is co-rotating with the Earth (an assumption in essence ignoring
winds) and neglecting the thermal motion of the molecules, it is relatively
easy to calculate the transfer of linear momentum from the atmosphere to the
satellite: During a short time interval \(\Delta t\) the velocity \(\dot{\vec{r_{rel}}}\) 
of the satellite relative to the particles may be assumed constant. Assuming furthermore that
all molecules and atoms encountered by the satellite's cross section normal 
to \(\dot{\vec{r_{rel}}}\) are absorbed by the satellite, the linear momentum lost by the satel-
lite equals the product of the volume \(A \Delta t \lvert \dot{\vec{r_{rel}}} \rvert \) 
of the cylinder with height \(\Delta t \dot{\vec{r_{rel}}} \)  and ground surface \(A\) 
with the density \(\rho(\vec{r})\) and the velocity \(- \dot{\vec{r_{rel}}} \) of the
molecules relative to the satellite at the current position of the satellite. The
loss of linear momentum by the satellite may thus be computed as \cite{BeutlerVII}:
\begin{equation}
    \Delta \rho = - \rho(\vec{r}) A {\dot{\vec{r_{rel}}}}^2 \Delta t 
    \frac{\dot{\vec{r_{rel}}}}{\lvert \dot{\vec{r_{rel}}} \rvert}
\end{equation}

The velocity change experienced during the time interval \(\Delta t\) is obtained by
dividing this expression through the time interval \(\Delta t\) and the mass of the
satellite \(m\). The acceleration of the satellite due to drag is obtained by
the limit-process \(\Delta t \to 0\) and reads as \cite{BeutlerVII}:
\begin{equation}
    \alpha_{d} = - \rho(\vec{r}) \frac{A}{m} {\dot{\vec{r_{rel}}}}^2 
    \frac{\dot{\vec{r_{rel}}}}{\lvert \dot{\vec{r_{rel}}} \rvert}
\end{equation}

The assumptions made so far, are not fully met in reality: Only a
fraction of the particles is actually absorbed by the satellite, the rest is re-
ﬂected by the satellite's surface. In order to take such eﬀects into account we
have to know the shape and the attitude of the satellite, except for satellites
with rotational symmetry w.r.t. the velocity vector in the Earth-ﬁxed system.

The basic equation for aerodynamic drag can thus be more generaly formulated as (\cite{Vallado}):
\begin{equation}
    \label{eq:val828}
    \ddot{\vec{r}} = -\frac{1}{2} \frac{c_D A}{m} \rho 
    \dot{\vec{r_{rel}}^2} 
    \frac{\dot{\vec{r_{rel}}}}{\lvert \dot{\vec{r_{rel}}} \rvert}
\end{equation}

where:
\begin{itemize}
    \item \(c_D\) is the coefficient of drag; a dimensionless quantity which reflects 
    the satellite's susceptibility to drag forces. For spherical satellites (independent of the
fraction of absorbed and reﬂected particles) and for satellites absorbing all
molecules hitting the satellite, the coefficient is \(c_D = 2\). In general one may assume 
that \cite{BeutlerVII}
\begin{equation}
    2 \leq c_D \leq 2.5
\end{equation}
    \item \(\rho\) is the atmospheric density which indicates how dense the atmosphere 
    is at the satellite altitude and is perhaps the most difficult parameter to determine.
    \item \(A\) is the cross-sectional area, defined to be the area which is normal 
    to the satellite's velocity vector.
    \item \(m/(c_D A)\) is called the \emph{ballistic coefficient}.
\end{itemize}
The direction of the drag acceleration is always (anti-)parallel to the relative 
velocity vector, indicated by the unit vector 
\(\vec{e_u} = \dot{\vec{r_{rel}}} / \lvert \dot{\vec{r_{rel}}} \rvert \)

Note that in \ref{eq:val828}, \(\vec{r_{rel}}\) is not the velocity vector 
typically found in the state vector. This velocity vector is relative to the 
atmosphere, which depends on complex atmospheric dynamics. However, a reasonable 
approximation of the relative velocity is obtained with the assumption that the 
atmosphere co-rotates with the Earth:
\begin{equation}
    %\begin{align}
    \dot{\vec{r_{rel}}} = \frac{d\vec{r}}{dt} - \vec{\omega}_{\Earth} \times \vec{r} = 
        \begin{bmatrix}
        \frac{dx}{dt}+{\omega}_{\Earth}y \\
        \frac{dy}{dt}-{\omega}_{\Earth}x \\
        \frac{dz}{dt}
        \end{bmatrix}
    %\end{align} 
\end{equation}
with the inertial satellite velocity vector \(d\vec{r}/{dt}\), the position vector 
\(\vec{r}\), and the Earth's angular velocity vector \(\vec{\omega}_{\Earth}\). 
As the drag force depends on the atmospheric density \(\rho\) at the satellite 
location, the modeling of the complex properties and dynamics of the Earth's 
atmosphere is a challenging task of modern precision orbit determination.

\subsection{Magnetic Field Models}
The effect of the magnetic variations of the Earth and Sun is useful with calculations of
atmospheric density because it's believed that magnetic variations are related to fluctua-
tions in atmospheric density. The charged particles from any magnetic disturbances cause ionization in the upper atmosphere,
thereby affecting the density and, subsequently, the drag. \ul{The effects of
drag resulting from magnetic disturbances are noticeable for satellites at altitudes
between 300 km and 1000 km} (\cite{Vallado}).

\subsection{Solar Flux}
The contribution of solar flux to atmospheric density is mainly from incoming solar
radiation. Solar flux (or Extreme Ultra-Violet, EUV, radiation that heats the upper
atmosphere, \(F_{EUV}\). Solar flux receives a lot of attention because it is an important parameter in determining
atmospheric density. The primary quantity, \(F_{10.7}\), has been used as a proxy for the EUV
radiation for many years.

\subsection{Model Atmospheres}
Numerous density models have been developed over the past few decades to find density, 
both static and time-varying, to satisfy differing accuracy models.
\begin{itemize}
    \item \emph{Exponential Model (0-1000 km)}, simple, static model assumes the density of the atmosphere decays exponentially
    with increasing altitude. Locally, density variation may be accounted for by the barometric formula
    \begin{equation}
        \rho (h) = {\rho}_0  e^{-\frac{h-h_0}{H_0}}
    \end{equation}
    where \({\rho}_0\) is the density at the reference height \(h_0\) and \(H_0\) 
    is the scaling height at \(h_0\) (see \cite{Vallado} for values of the coefficients).
    \item \emph{NRLMSIS-00 (0-2000 km)}\cite{nrlmsise00}, quite accurate and has 
    been successfully applied to many stressing problems.
\end{itemize}

\section{Radiation Pressure}
\subsection{Solar Radiation and Radiation Pressure}
Quantum mechanics says that each photon of frequency \(\nu\) and wavelength
\(\lambda = c / \nu\) (where \(c\) is the speed of light in vacuum) carries the energy
\begin{equation}
    E = h \nu
\end{equation}
and the linear momentum
\begin{equation}
    \vec{p} = \frac{h \nu}{c} \vec{e}
\end{equation}
where \(h=6.62\cdot10^{-34}\) Js is Planck's constant and \(\vec{e}\) is the unit 
vector of the propagation of the photon.

The momentum transferred per time unit onto a unit surface in a radiation
ﬁeld is called radiation pressure (hence a vectorial quantity).

In a general radiation ﬁeld it may be quite an elaborate task to calculate
the radiation pressure acting on a surface element. The underlying principle
is simple, however (the subsequent elaboration follows \cite{BeutlerVII}): 
We have to calculate the change \(\Delta \vec{p} = \vec{p}_a -\vec{p}_b\) of 
linear momentum \(\vec{p}\) for each of the photons hitting the surface element 
\(S\) (the index \(b\) characterizes the momentum before, \(a\) that after hitting the surface).
The momentum transferred to the surface element must be 
\(\vec{p_s} \equiv - \Delta \vec{p} = \vec{p}_b -\vec{p}_a \).
After having computed the momentum transferred by each of the photons
we simply have to compute the vectorial sum of the momenta \(\vec{p_s}\).

According to the law of conservation of linear momentum \(-\Delta \vec{p}\) is 
the momentum gained by the surface element. If the photon is absorbed by the surface, 
\(\vec{p}_a = 0\) and the surface gains the momentum \({\vec{p}}_{abs} = \vec{p}_b\).
If the photon is reﬂected by the surface, the photon is reﬂected according to Snellius' law
of reﬂection. The surface gains linear momentum normal to its surface with
absolute value \(2 \lvert \vec{p}_b \rvert cos\alpha = \lvert {\vec{p}}_{ref} \rvert\).

The primary radiation source to be considered in satellite geodesy is the
Sun. The radiation pressure due to the direct solar radiation is also referred
to as \emph{direct radiation pressure}. Other sources of radiation are the Earth, which
reﬂects and/or re-emits the radiation received by the Sun, or to a much lesser
extent, the Moon, reﬂecting the solar radiation.

The radiation ﬁeld due to the direct solar radiation may be considered as
parallel to the direction \(Sun \to Satellite\). Consequently, the momentum trans-
ferred per second to a unit surface normal to this direction may be expressed
by the solar constant \(S = \SI{1368}{\watt\per\square\m}\), giving the energy ﬂowing through this surface per
time unit at the distance of \SI{1}{\astronomicalunit}.

If 100\% of the radiation is absorbed,  the linear momentum
\begin{equation}
    \vec{p} = \frac{S}{c} \vec{e}
\end{equation}
is gained in one second by a surface element of \SI{1}{\square\metre} normal to 
the direction \(Sun \to Satellite\) element at \SI{1}{\astronomicalunit}. The 
absolute value of the vector is
\begin{equation}
    \lvert \vec{p} \rvert = \frac{S}{c} = \SI{4.56316e-6}{\N\per\square\m}
\end{equation}
Obviously, the surface of the cross section of the satellite normal to the 
direction \(Sun \to Satellite\) and the mass \(m\) of the satellite play the same roles as 
the corresponding quantities when dealing with drag (\ref{ssec:acceleration-due-to-drag}).

Assuming rotational symmetry of the satellite w.r.t. the axis \(Sun \to Satellite\), 
the acceleration due to the direct solar radiation may be written as (\cite{BeutlerVII})
\footnote{Note that \cite{Vallado} uses an alternate formulation for \ref{eq:beutler3142}, 
namely: \( \vec{\alpha}_{srp} =  - \frac{p_{srp} C_R A_{\Sun}}{m} \frac{{\vec{r}}_{sat\Sun}}{\lvert {\vec{r}}_{sat\Sun} \rvert} \), 
where \(p_{srp} \approx \SI{4.57e-6}{\N\per\square\m}\) is the solar pressure force 
per unit area, or the change in momentum, \(C_R\) is the \emph{reflectivity} and 
\(A_{\Sun}\) the exposed area to the Sun. Determining \(C_R\) is extremely
difficult. It changes over time and is virtually impossible to predict. This is especially
true for complex satellites made of various materials, that enter and exit eclipse regions,
and have a constantly changing orientation. For this reason, it's almost always a solution
parameter, determined in differential correction (just like the drag coefficient).}:
\begin{equation}
    \label{eq:beutler3142}
    {\vec{\alpha}}_{rad} = \frac{\tilde{C}}{2} 
    \frac{{AU}^2}{{\lvert \vec{r} - \vec{r_{\Sun}} \rvert}^2}
    \frac{S}{c} \frac{A}{m}
    \frac{\vec{r} - \vec{r_{\Sun}}}{\lvert \vec{r} - \vec{r_{\Sun}} \rvert}
\end{equation}
where:
\begin{itemize}
\item[\(\tilde{C}\)] depends on the reﬂective properties of the satellite surface,
\item[\(\vec{r}\)] is the geocentric position vector of the satellite,
\item[\(\vec{r_{\Sun}}\)] is the geocentric position vector of the Sun,
\item[\(AU\)] is the Astronomical Unit,
\item[\(m\)] is the mass of the satellite, and
\item[\(A\)] is the cross section of the satellite normal to the direction \(Sun \to Satellite\)
\end{itemize}

Rotational symmetry w.r.t. the axis \(Sun \to Satellite\) may not always
be assumed. Nevertheless, formula \ref{eq:beutler3142} is in practice an excellent ﬁrst-
order approximation to take radiation pressure into account. If the radiation
is mainly absorbed (as it should be the case, e.g., for solar panels), formula 
\ref{eq:beutler3142} is correct for satellites of arbitrary shape (\cite{BeutlerVII}).
Note that in contrast to atmospheric drag, direct radiation pressure practically does 
not depend on the height of the satellite above the Earth's surface. This is one of 
the reasons why radiation pressure is the dominating non-gravitational perturbation 
above heights of about \SI{600}{\km} (\cite{BeutlerVII}).

Radiation pressure obviously is ``turned oﬀ'' if the radiation is blocked by an 
``obstacle'', i.e the Moon or Earth, between the Sun and the satellite. 

\section{Satellite Eclispes and Earth Shadow}
Satellites routinely enter eclipse periods during their orbits, and
this can cause a great fluctuation in the available solar radiation for the solar 
arrays.

Examining \ref{fig:eclipse-geometry}, we are interested in two main regions: the 
\emph{umbra} is totally eclipsed by the primary body (Earth); the \emph{penumbra} 
is only partially obscured by the primary.
\begin{equation}
    \sin({\alpha}_{umb}) = \frac{r_S - r_E}{R} \text{ and }
    \sin({\alpha}_{pen}) = \frac{r_S + r_E}{R}
\end{equation}

If we consider the the primary (or occulting) body to be the Earth and the 
secondary body to be the Sun, then:
\begin{equation}
    \sin({\alpha}_{umb}) = \frac{r_{\Sun} - r_{\Earth}}{R_{\Earth\Sun}} 
    \Rightarrow {\alpha}_{umb} \approx \SI{0.264}{\degree}
    \text{ and }
    \sin({\alpha}_{pen}) = \frac{r_{\Sun} + r_{\Earth}}{R_{\Earth\Sun}}
    \Rightarrow {\alpha}_{pen} \approx \SI{0.269}{\degree}
\end{equation}

\begin{figure}
\centering
\input{tikz/eclipse-geometry.tikz}
\caption{Eclipse Geometry; \emph{scales are greatly exaggerated}}
\label{fig:eclipse-geometry}
\end{figure}

The distance from the occulting planet to the vertex (\(V\)) can be found via 
using the similar triangles (see \ref{fig:eclipse-geometry}):
\begin{equation}
    \label{eq:val501}
    \frac{\overline{EV}}{r_{E}} = \frac{\overline{SV}}{r_S} \Rightarrow \overline{EV} = \overline{SV} \frac{r_E}{r_S}
\end{equation}
We know the (ralative) position of the two (primary and secondary) planets, hence:
\(\overline{SV} = R + \overline{EV}\); substituting into \ref{eq:val501} yields:
\begin{align*}
    \label{eq:val51}
    \overline{EV} &= R \frac{r_E}{r_S} + \overline{EV} \frac{r_E}{r_S} \\
    \overline{EV} (1-\frac{r_E}{r_S}) &= R \frac{r_E}{r_S} \\
    \overline{EV} &= R \frac{r_E}{r_S - r_E}
\end{align*}

Using values for the Earth and the Sun, we find \(\overline{PV}\) to 
be \SI{1.384e6}{\km}. This is almost four times the distance from the 
Earth to the Moon (\SI{3.8268e5}{\km}) (\cite{Vallado}). Hence, it comes as little surprise 
that the Earth's shadow sometimes completely obscures the Moon, causing a 
lunar eclipse. Using values for the Moon and the Sun, 
\ref{eq:val51} yields a value of about \SI{3.735e5}{\km} (\cite{Vallado}) 
which is not too far from the Earth-Moon distance (approximately 
\SI{3.844e5}{\km}). When the Moon obscures part of the Earth's surface with its 
shadow, it causes a \emph{solar eclipse}.

\section{Third Body Perturbations}
An artificial satellite of the Earth experiences the gravitational attraction of
the Sun, the Moon, and to a lesser extent the planets and other bodies in the solar 
system. This perturbation is often referred to as the \emph{third-body effect}.

According to Newton's law of gravity, the acceleration of a satellite by a point 
mass \(M\) is given by:
\begin{equation}
  \label{eq:mont335}
  \ddot{\vec{r}} = G M \frac{\vec{s} - \vec{r}}{\lvert \vec{s} - \vec{r} {\rvert}^3}
\end{equation}

where \(\vec{r}\) and \(\vec{s}\) re the geocentric coordinates of the satellite 
and of \(M\) respectively. Note that the value of \(\ddot{\vec{r}}\) in \ref{eq:mont335} 
refers to an \emph{inertial} or Newtonian coordinate system in which the Earth is 
not at rest, but is itself subject to an acceleration:
\begin{equation}
  \ddot{\vec{r}} = G M \frac{\vec{s}}{\lvert \vec{s} {\rvert}^3}
\end{equation}

due to \(M\). Thus, the second derivative of the satellite's Earth-centered position 
vector is (\cite{Montenbruck2000}):
\begin{equation}
  \label{eq:mont337}
  \ddot{\vec{r}} = G M \left( \frac{\vec{s} - \vec{r}}{\lvert \vec{s} - \vec{r} {\rvert}^3} 
   - \frac{\vec{s}}{\lvert \vec{s} {\rvert}^3} \right)
\end{equation}

the first term in \ref{eq:mont337}, \(\frac{\vec{s} - \vec{r}}{\lvert \vec{s} - \vec{r} {\rvert}^3}\), 
is known as the \emph{direct effect} and the second term, \(\frac{\vec{s}}{\lvert \vec{s} {\rvert}^3}\), 
is the \emph{indirect effect}. The notation for the latter term arises from the observation that it
is independent of the artificial satellite coordinates. Since \ref{eq:mon337} describes
the satellite motion with respect to the Earth center of mass, which is a noninertial
point, the indirect term accounts for the inertial acceleration of the geocenter 
(\cite{tapley}). 

The third-body terms in \ref{eq:mont337} are based on the assumption that the
satellite, Earth, and perturbing body are point masses (or spheres of constant 
density), an assumption which is acceptable for most applications.

The nature of the third-body perturbation is similar to the Earth oblateness
effect; namely, the Sun and Moon produce a secular variation in the satellite node,
argument of perigee, and mean anomaly (\cite{tapley}).
