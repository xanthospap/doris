\chapter{Satellite Orbits}
\label{ch:satellite-orbits}

\section{Geopotential}
For precise orbit determination, we need to drop the assumption of the total mass 
of the Earth being concentrated in the center of the coordinate system. For the
following discussion of a more realistic model is adopted, where it is convenient 
to use an equivalent representation involving the gradient of the corresponding 
gravity potential \(U\)
\begin{equation}
    \ddot{\vec{r}} = \nabla U \textrm{ where } U = G M_{\Earth} \frac{1}{r}
\end{equation}

This expression for the potential may easily be generalized to an arbitrary mass
distribution by summing up the contributions created by individual mass elements
\(dm = \rho(\vec{s}) d^3 \vec{s}\) according to (\cite{Montenbruck2000})
\begin{equation}
    U = G \int{\frac{\rho(\vec{s}) d^3 \vec{s}}{\lvert \vec{r} - \vec{s} \rvert}}
\end{equation}

For computations, the Earth's gravity potential at point \((\phi , \lambda)\) 
can be approximated using a spherical harmonics expansion 
(e.g. \cite{Montenbruck2000})
\begin{equation}
    U = \frac{G M_{\Earth}}{r} \sum_{n=0}^\infty \sum_{m=0}^n 
    \frac{R_{\Earth}^n}{r^n} P_{nm}(sin\phi) 
    (C_{nm} cos(m\lambda) + S_{nm} sin(m\lambda))
\end{equation}

with the coefficients \(C_{nm}\) and \(S_{nm}\) describing the dependence on the 
Earth's internal mass distribution. These coefficients can be extracted from a 
suitable  \emph{geopotential model}.

Note that Geopotential coefficients with \(m=0\) are called  \emph{zonal} coefficients, 
since they describe the part of the potential that does not depend on the longitude. 
All \(S_{n0}\) vanish due to their definition, and the notation \(J_n = -C_{n0}\) 
is commonly used for the remaining zonal terms. The other geopotential coefficients
are known as \emph{tesseral} and \emph{sectorial} coefficients for \(m<n\) and 
\(m = n\), respectively.

\fbox{\begin{minipage}{.9\textwidth}
To compute the acceleration \(\ddot{\vec{r}}\), which is equal to the 
gradient of \(U\), we use the recursion formulas described in \cite{Montenbruck2000}.
Note that these expressions, use the \underline{non-normalized} harmonic 
coefficients. 
\end{minipage}}

\subsection{Gravity Models}
The \href{http://icgem.gfz-potsdam.de/home}{International Centre for Global Earth Models (ICGEM)}  
(\cite{icgempub}) web service hosts a large number of gravity field models, 
published in what is called the \emph{The ICGEM-format}(\cite{ICGEMFormat}). 

Such static model files can be parsed and the respective harmonic coeefficients 
(\(C_{nm}\) and \(S_{nm}\)) be used to compute satellite acceleration induced by 
the geopotential.

\section{Sun and Moon Perturbing Acceleration}
According to Newton's law of gravity, the acceleration of a satellite by a point 
mass \(M\) is given by:
\begin{equation}
    \label{eq:mon335}
    \ddot{\vec{r}} = G M \frac{\vec{s}-\vec{r}}{\lvert \vec{s} - \vec{r} \rvert ^3}
\end{equation}
where \(\vec{r}\) and \(\vec{s}\) are the geocentric coordinates of the satellite 
and of \(M\) respectively. Some care is required, however, before this expression 
can be used for describing the satellite's motion with respect to the center of 
the Earth. The value of \(\ddot{\vec{r}}\) in \ref{eq:mon335} refers to an 
inertial or Newtonian coordinate system in which the Earth is not at rest, but 
is itself subject to an acceleration
\begin{equation}
    \ddot{\vec{r}} = G M \frac{\vec{s}}{\lvert \vec{s} \rvert ^3}
\end{equation}
due to M. Both values have to be subtracted to obtain the second derivative
\begin{equation}
    \label{eq:mon337}
    \ddot{\vec{r}} = G M (\frac{\vec{s}-\vec{r}}{\lvert \vec{s} - \vec{r} \rvert ^3} - \frac{\vec{s}}{\lvert \vec{s} \rvert ^3})
\end{equation}
of the satellite's Earth-centered position vector.

\subsection{Sun, Moon and Planetary Ephemerides}
To use the formula \ref{eq:mon337} we need the (geocentric) coordinates of the 
Sun and Moon. To that end, we can either use low-precision solar and lunar 
coordinates (as described e.g. in \cite{Montenbruck2000} and \cite{Vallado}) or 
use JPL Ephemerides. Both options are available.

\subsubsection{JPL Ephemerides}
Jet Propulsion Laboratory Development Ephemeris (abbreved JPL DE(number), or 
simply DE(number)) designates one of a series of mathematical models of the 
Solar System produced at the \href{https://www.jpl.nasa.gov/}{Jet Propulsion Laboratory} 
for use in spacecraft navigation and astronomy. The models consist of numeric 
representations of positions, velocities and accelerations of major Solar System 
bodies, tabulated at equally spaced intervals of time, covering a specified 
span of years (\cite{wiki-jplde}). Further information and a description of 
vailable ephemerides, can be found at the 
\href{https://ssd.jpl.nasa.gov/planets/eph_export.html}{JPL Planetary and Lunar Ephemerides} website.

We use an interface to the JPL-provided Observation Geometry System
for Space Science Missions (\href{https://naif.jpl.nasa.gov/naif/}{SPICE}) 
software library \footnote{based on the C version of the the 
\href{https://naif.jpl.nasa.gov/naif/toolkit_C.html}{Navigation and Ancillary Information facilty}} 
to extract planet coordinates. 

\section{Atmospheric Drag}
Next to the oblateness of the Earth, atmospheric drag most strongly influences the
motion of a satellite near Earth; in fact, during the last few revolutions of the satellite's
life, drag effects can be more dominant than those from the Earth's oblateness. For more
distant satellites, third-body effects and solar-radiation pressure dominate more than
oblateness and drag (\cite{Vallado}). Atmospheric forces represent the largest 
non-gravitational perturbations acting on low altitude satellites.

The cause of drag is the atmospheric particles, which retard the satellite's motion.
Calculating density is extremely complex for real-world problems.

\subsection{Acceleration Due to Drag}
The basic equation for aerodynamic drag combines several factors; I'm showing it here
as a specific force or acceleration (\cite{Vallado}):
\begin{equation}
    \label{eq:val828}
    \ddot{\vec{r}} = -\frac{1}{2} \frac{c_D A}{m} \rho 
    \dot{\vec{r_{rel}}^2} 
    \frac{\dot{\vec{r_{rel}}}}{\lvert \dot{\vec{r_{rel}}} \rvert}
\end{equation}

where:
\begin{itemize}
    \item \(c_D\) is the coefficient of drag; a dimensionless quantity which reflects 
    the satellite's susceptibility to drag forces. 
    \item \(\rho\) is the atmospheric density which indicates how dense the atmosphere 
    is at the satellite altitude and is perhaps the most difficult parameter to determine.
    \item \(A\) is the cross-sectional area, defined to be the area which is normal 
    to the satellite's velocity vector.
    \item \(m/(c_D A)\) is called the ballistic coefficient.
\end{itemize}
The direction of the drag acceleration is always (anti-)parallel to the relative 
velocity vector, indicated by the unit vector 
\(\vec{e_u} = \dot{\vec{r_{rel}}} / \lvert \dot{\vec{r_{rel}}} \rvert \)

Note that in \ref{eq:val828}, \(\vec{r_{rel}}\) is not the velocity vector 
typically found in the state vector. This velocity vector is relative to the 
atmosphere, which depends on complex atmospheric dynamics. However, a reasonable 
approximation of the relative velocity is obtained with the assumption that the 
atmosphere co-rotates with the Earth:
\begin{equation}
    %\begin{align}
    \dot{\vec{r_{rel}}} = \frac{d\vec{r}}{dt} - \vec{\omega}_{\Earth} \times \vec{r} = 
        \begin{bmatrix}
        \frac{dx}{dt}+{\omega}_{\Earth}y \\
        \frac{dy}{dt}-{\omega}_{\Earth}x \\
        \frac{dz}{dt}
        \end{bmatrix}
    %\end{align} 
\end{equation}
with the inertial satellite velocity vector \(d\vec{r}/{dt}\), the position vector 
\(\vec{r}\), and the Earth's angular velocity vector \(\vec{\omega}_{\Earth}\). 
As the drag force depends on the atmospheric density \(\rho\) at the satellite 
location, the modeling of the complex properties and dynamics of the Earth's 
atmosphere is a challenging task of modern precision orbit determination.

\subsection{Magnetic Field Models}
The effect of the magnetic variations of the Earth and Sun is useful with calculations of
atmospheric density because it's believed that magnetic variations are related to fluctua-
tions in atmospheric density. The charged particles from any magnetic disturbances cause ionization in the upper atmosphere,
thereby affecting the density and, subsequently, the drag. \ul{The effects of
drag resulting from magnetic disturbances are noticeable for satellites at altitudes
between 300 km and 1000 km} (\cite{Vallado}).

\subsection{Solar Flux}
The contribution of solar flux to atmospheric density is mainly from incoming solar
radiation. Solar flux (or Extreme Ultra-Violet, EUV, radiation that heats the upper
atmosphere, \(F_{EUV}\). Solar flux receives a lot of attention because it is an important parameter in determining
atmospheric density. The primary quantity, \(F_{10.7}\), has been used as a proxy for the EUV
radiation for many years.

\subsection{Model Atmospheres}
Numerous density models have been developed over the past few decades to find density, 
both static and time-varying, to satisfy differing accuracy models.
\begin{itemize}
    \item \emph{Exponential Model (0-1000 km)}, simple, static model assumes the density of the atmosphere decays exponentially
    with increasing altitude.
    \item \emph{NRLMSIS-00 (0-2000 km)}\cite{nrlmsise00}, quite accurate and has been successfully applied to many stressing problems.
\end{itemize}
